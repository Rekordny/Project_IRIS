#特雷森实行人类驱逐法案:纯人类种族添加om
TAU_add_om_deportation_of_humans = {
	for_each_scope_loop = {
		array = global.countries
		if = {
			limit = {
				has_country_flag = race_mark_human
			}
			add_opinion_modifier = {
				target = TAU
				modifier = TAU_deportation_of_humans_om
			}
		}
	}
}

#计算更新发展度
#发展度=(1+发展度附加值*0.1)*发展度国土基数/10
#国土基数在on_action每月更新
TAU_update_dev = {
	set_temp_variable = {
		TAU_temp_counter1 = tau_dev_bonus_factor
	}
	multiply_temp_variable = {
		TAU_temp_counter1 = 0.1
	}
	add_to_temp_variable = {
		TAU_temp_counter1 = 1
	}
	multiply_temp_variable = {
		TAU_temp_counter1 = tau_dev_base_factor
	}
	divide_temp_variable = {
		TAU_temp_counter1 = 10
	}
	set_variable = {
		tau_dev = TAU_temp_counter1
	}
}

#计算国土基数发展度并更新总发展度
#国土基数发展度 = 全省份战略值*
TAU_update_dev_base_factor = {
	set_temp_variable = {
		TAU_temp_counter1 = 0
	}
	for_each_scope_loop = {
		array = TAU.owned_states
		if = {
			limit = {
				is_core_of = PREV
			}
			add_to_temp_variable = {
				TAU_temp_counter1 = this.state_strategic_value
			}
		}
		else = {
			set_temp_variable = {
				TAU_temp_counter2 = this.state_strategic_value
			}
			#边际效应
			divide_temp_variable = {
				TAU_temp_counter2 = 1.3
			}
			if = {
				limit = {
					PREV = {
						controls_state > 20
					}
				}
				divide_temp_variable = {
					TAU_temp_counter2 = 1.7
				}
			}
			if = {
				limit = {
					PREV = {
						controls_state > 40
					}
				}
				divide_temp_variable = {
					TAU_temp_counter2 = 3
				}
			}
			add_to_temp_variable = {
				TAU_temp_counter1 = TAU_temp_counter2
			}
		}
	}
	set_variable = {
		tau_dev_base_factor = TAU_temp_counter1
	}
	TAU_update_dev = yes
}

#更新女神像获取
TAU_update_nsx = {
	for_each_scope_loop = {
		array = TAU.army_leaders
		if = {
			limit = {
				NOT = { has_unit_leader_flag = TAU_LEADER_EARNED_1 }
				skill > 2
			}
			set_unit_leader_flag = TAU_LEADER_EARNED_1
			TAU = {
				add_to_variable = { tau_nsx = 1 }
				log = "NSX: [?tau_nsx]"
			}
		}
		if = {
			limit = {
				TAU = { has_completed_focus = TAU_maximum_support_schedule }
				NOT = { has_unit_leader_flag = TAU_LEADER_EARNED_2 }
				skill > 4
			}
			set_unit_leader_flag = TAU_LEADER_EARNED_2
			TAU = {
				add_to_variable = { tau_nsx = 1 }
				log = "NSX: [?tau_nsx]"
			}
		}
		if = {
			limit = {
				TAU = { has_completed_focus = TAU_maximum_support_schedule }
				NOT = { has_unit_leader_flag = TAU_LEADER_EARNED_2 }
				skill > 4
			}
			set_unit_leader_flag = TAU_LEADER_EARNED_2
			TAU = {
				add_to_variable = { tau_nsx = 1 }
				log = "NSX: [?tau_nsx]"
			}
		}
	}
}

#移除副领导人
TAU_retire_vice_country_leader = {
	if = {
		limit = { has_idea = TAU_another_leader_AirGroove }
		remove_ideas = TAU_another_leader_AirGroove
	}
	if = {
		limit = { has_idea = TAU_another_leader_Urara }
		remove_ideas = TAU_another_leader_Urara
	}
	if = {
		limit = { has_idea = TAU_another_leader_OguriCap }
		remove_ideas = TAU_another_leader_OguriCap
	}
	if = {
		limit = { has_idea = TAU_another_leader_SatonoDiamond }
		remove_ideas = TAU_another_leader_SatonoDiamond
	}
	if = {
		limit = { has_idea = TAU_another_leader_KitasanBlack }
		remove_ideas = TAU_another_leader_KitasanBlack
	}
}