#提高贵族好感
BLA_increase_nobility_opinion = {
    custom_effect_tooltip = BLA_increase_nobility_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = 5}}
    BLA_check_nobility_opinion = yes
    }
}
#提高贵族好感-大
BLA_increase_nobility_opinion_big = {
    custom_effect_tooltip = BLA_increase_nobility_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = 10}}
    BLA_check_nobility_opinion = yes
    }
}
#降低贵族好感
BLA_decrease_nobility_opinion = {
    custom_effect_tooltip = BLA_decrease_nobility_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = -5}}
    BLA_check_nobility_opinion = yes
    }
}
#降低贵族好感-大
BLA_decrease_nobility_opinion_big = {
    custom_effect_tooltip = BLA_decrease_nobility_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = -10}}
    BLA_check_nobility_opinion = yes
    }
}
#提高教会好感
BLA_increase_church_opinion = {
    custom_effect_tooltip = BLA_increase_church_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_church_opinion = 5}}
    BLA_check_church_opinion = yes
    }
}
#提高教会好感-大
BLA_increase_church_opinion_big = {
    custom_effect_tooltip = BLA_increase_church_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_church_opinion = 10}}
    BLA_check_church_opinion = yes
    }
}
#降低教会好感
BLA_decrease_church_opinion = {
    custom_effect_tooltip = BLA_decrease_church_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_church_opinion = -5}}
    BLA_check_church_opinion = yes
    }
}
#降低教会好感-大
BLA_decrease_church_opinion_big = {
    custom_effect_tooltip = BLA_decrease_church_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_church_opinion = -10}}
    BLA_check_church_opinion = yes
    }
}
#提高军队好感
BLA_increase_army_opinion = {
    custom_effect_tooltip = BLA_increase_army_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_army_opinion = 5}}
    BLA_check_army_opinion = yes
    }
}
#提高军队好感-大
BLA_increase_army_opinion_big = {
    custom_effect_tooltip = BLA_increase_army_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_army_opinion = 10}}
    BLA_check_army_opinion = yes
    }
}
#降低军队好感
BLA_decrease_army_opinion = {
    custom_effect_tooltip = BLA_decrease_army_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_army_opinion = -5}}
    BLA_check_army_opinion = yes
    }
}
#降低军队好感-大
BLA_decrease_army_opinion_big = {
    custom_effect_tooltip = BLA_decrease_army_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_army_opinion = -10}}
    BLA_check_army_opinion = yes
    }
}
#提高实业家好感
BLA_increase_capitalist_opinion = {
    custom_effect_tooltip = BLA_increase_capitalist_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_capitalist_opinion = 5}}
    BLA_check_capitalist_opinion = yes
    }
}
#提高实业家好感-大
BLA_increase_capitalist_opinion_big = {
    custom_effect_tooltip = BLA_increase_capitalist_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_capitalist_opinion = 10}}
    BLA_check_capitalist_opinion = yes
    }
}
#降低实业家好感
BLA_decrease_capitalist_opinion = {
    custom_effect_tooltip = BLA_decrease_capitalist_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_capitalist_opinion = -5}}
    BLA_check_capitalist_opinion = yes
    }
}
#降低实业家好感-大
BLA_decrease_capitalist_opinion_big = {
    custom_effect_tooltip = BLA_decrease_capitalist_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_capitalist_opinion = -10}}
    BLA_check_capitalist_opinion = yes
    }
}
#提高自由民好感
BLA_increase_freeman_opinion = {
    custom_effect_tooltip = BLA_increase_freeman_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_freeman_opinion = 5}}
    BLA_check_freeman_opinion = yes
    }
}
#提高自由民好感-大
BLA_increase_freeman_opinion_big = {
    custom_effect_tooltip = BLA_increase_freeman_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_freeman_opinion = 10}}
    BLA_check_freeman_opinion = yes
    }
}
#降低自由民好感
BLA_decrease_freeman_opinion = {
    custom_effect_tooltip = BLA_decrease_freeman_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_freeman_opinion = -5}}
    BLA_check_freeman_opinion = yes
    }
}
#降低自由民好感-大
BLA_decrease_freeman_opinion_big = {
    custom_effect_tooltip = BLA_decrease_freeman_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_freeman_opinion = -10}}
    BLA_check_freeman_opinion = yes
    }
}
#提高农奴好感
BLA_increase_serf_opinion = {
    custom_effect_tooltip = BLA_increase_serf_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_serf_opinion = 5}}
    BLA_check_serf_opinion = yes
    }
}
#提高农奴好感-大
BLA_increase_serf_opinion_big = {
    custom_effect_tooltip = BLA_increase_serf_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_serf_opinion = 10}}
    BLA_check_serf_opinion = yes
    }
}
#降低农奴好感
BLA_decrease_serf_opinion = {
    custom_effect_tooltip = BLA_decrease_serf_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_serf_opinion = -5}}
    BLA_check_serf_opinion = yes
    }
}
#降低农奴好感-大
BLA_decrease_serf_opinion_big = {
    custom_effect_tooltip = BLA_decrease_serf_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_serf_opinion = -10}}
    BLA_check_serf_opinion = yes
    }
}
#提高所有好感
BLA_increase_all_opinion = {
    custom_effect_tooltip = BLA_increase_all_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = 5}}
    BLA_check_nobility_opinion = yes
    BLA = {add_to_variable = {BLA_church_opinion = 5}}
    BLA_check_church_opinion = yes
    BLA = {add_to_variable = {BLA_army_opinion = 5}}
    BLA_check_army_opinion = yes
    BLA = {add_to_variable = {BLA_capitalist_opinion = 5}}
    BLA_check_capitalist_opinion = yes
    BLA = {add_to_variable = {BLA_freeman_opinion = 5}}
    BLA_check_freeman_opinion = yes
    BLA = {add_to_variable = {BLA_serf_opinion = 5}}
    BLA_check_serf_opinion = yes
    }
}
#降低所有好感
BLA_decrease_all_opinion = {
    custom_effect_tooltip = BLA_decrease_all_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = -5}}
    BLA_check_nobility_opinion = yes
    BLA = {add_to_variable = {BLA_church_opinion = -5}}
    BLA_check_church_opinion = yes
    BLA = {add_to_variable = {BLA_army_opinion = -5}}
    BLA_check_army_opinion = yes
    BLA = {add_to_variable = {BLA_capitalist_opinion = -5}}
    BLA_check_capitalist_opinion = yes
    BLA = {add_to_variable = {BLA_freeman_opinion = -5}}
    BLA_check_freeman_opinion = yes
    BLA = {add_to_variable = {BLA_serf_opinion = -5}}
    BLA_check_serf_opinion = yes
    }
}
#检测贵族好感
BLA_check_nobility_opinion = {
    if = {
        limit = {
            check_variable = {BLA_nobility_opinion < -100}
        }   
        set_variable = {BLA_nobility_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_nobility_opinion < -75}
            NOT = {has_country_flag = BLA_nobility_plot_triggered}
        }   
        country_event = {id = BLA_pol.999}
        set_country_flag = BLA_nobility_plot_triggered
    }
    if = {
        limit = {
            check_variable = {BLA_nobility_opinion > 100}
        }
        set_variable = {BLA_nobility_opinion = 100}
    }
}
#检测教会好感
BLA_check_church_opinion = {
    if = {
        limit = {
            check_variable = {BLA_church_opinion < -100}
        }
        set_variable = {BLA_church_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_church_opinion > 100}
        }
       set_variable = {BLA_church_opinion = 100}
    }
}
#检测军队好感
BLA_check_army_opinion = {
    if = {
        limit = {
           check_variable = {BLA_army_opinion < -100}
        }
        set_variable = {BLA_army_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_army_opinion > 100}
        }
        set_variable = {BLA_army_opinion = 100}
    }
}
#检测实业家好感
BLA_check_capitalist_opinion = {
    if = {
        limit = {
            check_variable = {BLA_capitalist_opinion < -100}
        }
        set_variable = {BLA_capitalist_opinion = -100}
    }
    if = {
        limit = {
           check_variable = {BLA_capitalist_opinion > 100}
        }
       set_variable = {BLA_capitalist_opinion = 100}
    }
}
#检测自由民好感
BLA_check_freeman_opinion = {
    if = {
        limit = {
            check_variable = {BLA_freeman_opinion < -100}
        }
        set_variable = {BLA_freeman_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_freeman_opinion > 100}
        }
        set_variable = {BLA_freeman_opinion = 100}
    }
}
#检测农奴好感
BLA_check_serf_opinion = {
    if = {
        limit = {
            check_variable = {BLA_serf_opinion < -100}
        }
        set_variable = {BLA_serf_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_serf_opinion > 20}
        }
        set_variable = {BLA_serf_opinion = 20}
    }
}
#每周变化
BLA_opinion_weekly_change = {
    BLA = {
        add_to_variable = {BLA_nobility_opinion = BLA_nobility_opinion_change}
        add_to_variable = {BLA_church_opinion = BLA_church_opinion_change}
        add_to_variable = {BLA_army_opinion = BLA_army_opinion_change}
        add_to_variable = {BLA_capitalist_opinion = BLA_capitalist_opinion_change}
        add_to_variable = {BLA_freeman_opinion = BLA_freeman_opinion_change}
        add_to_variable = {BLA_serf_opinion = BLA_serf_opinion_change}
        BLA_check_nobility_opinion = yes
        BLA_check_church_opinion = yes
        BLA_check_army_opinion = yes
        BLA_check_capitalist_opinion = yes
        BLA_check_freeman_opinion = yes
        BLA_check_serf_opinion = yes
    }
}
#刷新动态修正
BLA_update_rot = {
    hidden_effect = {
        BLA = {
            set_variable = {BLA_dynamic_stability_factor = BLA_stability_factor}
			set_variable = {BLA_dynamic_political_power_gain = BLA_political_power_gain}
			set_variable = {BLA_dynamic_army_morale_factor = BLA_army_morale_factor}
			set_variable = {BLA_dynamic_army_attack_factor = BLA_army_attack_factor}
			set_variable = {BLA_dynamic_army_defence_factor = BLA_army_defence_factor}
			set_variable = {BLA_dynamic_consumer_goods_factor = BLA_consumer_goods_factor}
			set_variable = {BLA_dynamic_conscription_factor = BLA_conscription_factor}
			set_variable = {BLA_dynamic_communism_drift = BLA_communism_drift}
			multiply_variable = { BLA_dynamic_stability_factor = BLA_nobility_opinion} #贵族
			multiply_variable = { BLA_dynamic_political_power_gain = BLA_church_opinion} #教会
			multiply_variable = { BLA_dynamic_army_morale_factor = BLA_church_opinion} #教会
			multiply_variable = { BLA_dynamic_army_attack_factor = BLA_army_opinion} #军队
			multiply_variable = { BLA_dynamic_army_defence_factor = BLA_army_opinion} #军队
			multiply_variable = { BLA_dynamic_consumer_goods_factor = BLA_capitalist_opinion} #实业家
			multiply_variable = { BLA_dynamic_conscription_factor = BLA_freeman_opinion} #自由民
			multiply_variable = { BLA_dynamic_communism_drift = BLA_serf_opinion} #农奴
            if = {
                limit = {
                    has_completed_focus = BLA_Anna_reform_7
                }
                add_to_variable = {BLA_dynamic_army_attack_factor = 0.05}
                add_to_variable = {BLA_dynamic_army_defence_factor = 0.05}
            }
        }
    }
}
#随机获得一个把柄
BLA_gain_random_secret = {
    custom_effect_tooltip = BLA_gain_random_secret_desc
    hidden_effect = {
        BLA = {
            random_list = {
                25 = {
                    add_to_variable = {BLA_nobility_secret = 1}
                }
                25 = {
                    add_to_variable = {BLA_church_secret = 1}
                }
                25 = {
                    add_to_variable = {BLA_army_secret = 1}
                }
                25 = {
                    add_to_variable = {BLA_capitalist_secret = 1}
                }
            }
        }
    }
}
#计算贵族税收
BLA_calculate_nobility_tax = {
    if = {
        limit = {
            BLA = {check_variable = {BLA_nobility_opinion > 0}}
        }
        BLA = {
            set_variable = {BLA_nobility_tax = 0}
            set_variable = {BLA_nobility_tax = BLA_nobility_basic_tax}
            multiply_variable = {BLA_nobility_tax = BLA_nobility_opinion}
        }
    }
    if = {
        limit = {
            BLA = {check_variable = {BLA_nobility_tax < 5}}
        }
        BLA = {
            set_variable = {BLA_nobility_tax = 5}
        }
    }
}
#计算教会税收
BLA_calculate_church_tax = {
    if = {
        limit = {
            BLA = {check_variable = {BLA_church_opinion > 0}}
        }
        BLA = {
            set_variable = {BLA_church_tax = 0}
            set_variable = {BLA_church_tax = BLA_church_basic_tax}
            multiply_variable = {BLA_church_tax = BLA_church_opinion}
        }
    }
    else = {
        BLA = {set_variable = {BLA_church_tax = 0}}
    }
}
#计算资本家税收
BLA_calculate_capitalist_tax = {
    if = {
        limit = {
            BLA = {check_variable = {BLA_capitalist_opinion > 0}}
        }
        BLA = {
            set_variable = {BLA_capitalist_tax = 0}
            set_variable = {BLA_capitalist_tax = BLA_capitalist_basic_tax}
            multiply_variable = {BLA_capitalist_tax = BLA_capitalist_opinion}
        }
    }
    if = {
        limit = {
            BLA = {check_variable = {BLA_capitalist_tax < 5}}
        }
        BLA = {
            set_variable = {BLA_capitalist_tax = 5}
        }
    }
}
#结算再投资
BLA_calculate_reinvest = {
    BLA = {
        set_variable = {BLA_capitalist_reinvest = 0}
        set_variable = {BLA_capitalist_reinvest = num_of_civilian_factories}
		multiply_variable = {BLA_capitalist_reinvest = 0.2}
    }
}
#计算总体债务
BLA_calculate_total_debt = {
    BLA = {
        set_variable = {BLA_debt = 0}
        add_to_variable = {BLA_debt = BLA_other_debt}
        add_to_variable = {BLA_debt = BLA_ELN_debt}
        add_to_variable = {BLA_debt = BLA_ANZ_debt}
        add_to_variable = {BLA_debt = BLA_USR_debt}
        add_to_variable = {BLA_debt = BLA_USF_debt}
        add_to_variable = {BLA_debt = BLA_STG_debt}
        set_variable = {BLA_total_interest = BLA_debt}
		multiply_variable = {BLA_total_interest = 0.01}
    }

}
#计算总体收入
BLA_calculate_total_tax = {
    BLA = {
        add_to_variable = {BLA_industralization_fund = BLA_nobility_tax}
        add_to_variable = {BLA_industralization_fund = BLA_church_tax}
        add_to_variable = {BLA_industralization_fund = BLA_capitalist_tax}
        add_to_variable = {BLA_industralization_fund = BLA_freeman_tax}
        add_to_variable = {BLA_industralization_fund = BLA_serf_tax}
        add_to_variable = {BLA_industralization_fund = BLA_foreign_investment}
        add_to_variable = {BLA_industralization_fund = BLA_extra}
        add_to_variable = {BLA_industralization_fund = BLA_capitalist_reinvest}
        subtract_from_variable = {BLA_industralization_fund = BLA_total_interest}
    }
}
#检测工业化状况
BLA_check_industralization = {
    BLA = {
        if = {
            limit = {
                check_variable = {num_of_factories > BLA_industralization_target}
                check_variable = {BLA_industralization_status < 11}
            }
            BLA_upgrade_industralization = yes
            add_to_variable = {BLA_industralization_target = 10}
        }
    }
}
#提高工业化水平
BLA_upgrade_industralization = {
    BLA = {
        add_to_variable = {BLA_industralization_status = 1}
        add_to_variable = {BLA_dynamic_industrial_capacity_factory = 0.05}
        add_to_variable = {BLA_dynamic_industrial_capacity_dockyard = 0.05}
        add_to_variable = {BLA_dynamic_production_factory_max_efficiency_factor = 0.025}
        add_to_variable = {BLA_dynamic_production_speed_buildings_factor = 0.025}
        add_to_variable = {BLA_dynamic_local_resources_factor = 0.065}
        add_to_variable = {BLA_freeman_tax = 5}
        add_to_variable = {BLA_capitalist_basic_tax = 0.03}
    }
}
