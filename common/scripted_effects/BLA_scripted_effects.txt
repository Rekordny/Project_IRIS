#提高贵族好感
BLA_increase_nobility_opinion = {
    custom_effect_tooltip = BLA_increase_nobility_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = 5}}
    BLA_check_nobility_opinion = yes
    }
}
#提高贵族好感-大
BLA_increase_nobility_opinion_big = {
    custom_effect_tooltip = BLA_increase_nobility_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = 10}}
    BLA_check_nobility_opinion = yes
    }
}
#降低贵族好感
BLA_decrease_nobility_opinion = {
    custom_effect_tooltip = BLA_decrease_nobility_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = -5}}
    BLA_check_nobility_opinion = yes
    }
}
#降低贵族好感-大
BLA_decrease_nobility_opinion_big = {
    custom_effect_tooltip = BLA_decrease_nobility_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = -10}}
    BLA_check_nobility_opinion = yes
    }
}
#提高教会好感
BLA_increase_church_opinion = {
    custom_effect_tooltip = BLA_increase_church_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_church_opinion = 5}}
    BLA_check_church_opinion = yes
    }
}
#提高教会好感-大
BLA_increase_church_opinion_big = {
    custom_effect_tooltip = BLA_increase_church_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_church_opinion = 10}}
    BLA_check_church_opinion = yes
    }
}
#降低教会好感
BLA_decrease_church_opinion = {
    custom_effect_tooltip = BLA_decrease_church_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_church_opinion = -5}}
    BLA_check_church_opinion = yes
    }
}
#降低教会好感-大
BLA_decrease_church_opinion_big = {
    custom_effect_tooltip = BLA_decrease_church_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_church_opinion = -10}}
    BLA_check_church_opinion = yes
    }
}
#提高军队好感
BLA_increase_army_opinion = {
    custom_effect_tooltip = BLA_increase_army_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_army_opinion = 5}}
    BLA_check_army_opinion = yes
    }
}
#提高军队好感-大
BLA_increase_army_opinion_big = {
    custom_effect_tooltip = BLA_increase_army_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_army_opinion = 10}}
    BLA_check_army_opinion = yes
    }
}
#降低军队好感
BLA_decrease_army_opinion = {
    custom_effect_tooltip = BLA_decrease_army_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_army_opinion = -5}}
    BLA_check_army_opinion = yes
    }
}
#降低军队好感-大
BLA_decrease_army_opinion_big = {
    custom_effect_tooltip = BLA_decrease_army_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_army_opinion = -10}}
    BLA_check_army_opinion = yes
    }
}
#提高实业家好感
BLA_increase_capitalist_opinion = {
    custom_effect_tooltip = BLA_increase_capitalist_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_capitalist_opinion = 5}}
    BLA_check_capitalist_opinion = yes
    }
}
#提高实业家好感-大
BLA_increase_capitalist_opinion_big = {
    custom_effect_tooltip = BLA_increase_capitalist_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_capitalist_opinion = 10}}
    BLA_check_capitalist_opinion = yes
    }
}
#降低实业家好感
BLA_decrease_capitalist_opinion = {
    custom_effect_tooltip = BLA_decrease_capitalist_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_capitalist_opinion = -5}}
    BLA_check_capitalist_opinion = yes
    }
}
#降低实业家好感-大
BLA_decrease_capitalist_opinion_big = {
    custom_effect_tooltip = BLA_decrease_capitalist_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_capitalist_opinion = -10}}
    BLA_check_capitalist_opinion = yes
    }
}
#提高自由民好感
BLA_increase_freeman_opinion = {
    custom_effect_tooltip = BLA_increase_freeman_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_freeman_opinion = 5}}
    BLA_check_freeman_opinion = yes
    }
}
#提高自由民好感-大
BLA_increase_freeman_opinion_big = {
    custom_effect_tooltip = BLA_increase_freeman_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_freeman_opinion = 10}}
    BLA_check_freeman_opinion = yes
    }
}
#降低自由民好感
BLA_decrease_freeman_opinion = {
    custom_effect_tooltip = BLA_decrease_freeman_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_freeman_opinion = -5}}
    BLA_check_freeman_opinion = yes
    }
}
#降低自由民好感-大
BLA_decrease_freeman_opinion_big = {
    custom_effect_tooltip = BLA_decrease_freeman_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_freeman_opinion = -10}}
    BLA_check_freeman_opinion = yes
    }
}
#提高农奴好感
BLA_increase_serf_opinion = {
    custom_effect_tooltip = BLA_increase_serf_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_serf_opinion = 5}}
    BLA_check_serf_opinion = yes
    }
}
#提高农奴好感-大
BLA_increase_serf_opinion_big = {
    custom_effect_tooltip = BLA_increase_serf_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_serf_opinion = 10}}
    BLA_check_serf_opinion = yes
    }
}
#降低农奴好感
BLA_decrease_serf_opinion = {
    custom_effect_tooltip = BLA_decrease_serf_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_serf_opinion = -5}}
    BLA_check_serf_opinion = yes
    }
}
#降低农奴好感-大
BLA_decrease_serf_opinion_big = {
    custom_effect_tooltip = BLA_decrease_serf_opinion_big_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_serf_opinion = -10}}
    BLA_check_serf_opinion = yes
    }
}
#提高所有好感
BLA_increase_all_opinion = {
    custom_effect_tooltip = BLA_increase_all_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = 5}}
    BLA_check_nobility_opinion = yes
    BLA = {add_to_variable = {BLA_church_opinion = 5}}
    BLA_check_church_opinion = yes
    BLA = {add_to_variable = {BLA_army_opinion = 5}}
    BLA_check_army_opinion = yes
    BLA = {add_to_variable = {BLA_capitalist_opinion = 5}}
    BLA_check_capitalist_opinion = yes
    BLA = {add_to_variable = {BLA_freeman_opinion = 5}}
    BLA_check_freeman_opinion = yes
    BLA = {add_to_variable = {BLA_serf_opinion = 5}}
    BLA_check_serf_opinion = yes
    }
}
#降低所有好感
BLA_decrease_all_opinion = {
    custom_effect_tooltip = BLA_decrease_all_opinion_desc
    hidden_effect = {
    BLA = {add_to_variable = {BLA_nobility_opinion = -5}}
    BLA_check_nobility_opinion = yes
    BLA = {add_to_variable = {BLA_church_opinion = -5}}
    BLA_check_church_opinion = yes
    BLA = {add_to_variable = {BLA_army_opinion = -5}}
    BLA_check_army_opinion = yes
    BLA = {add_to_variable = {BLA_capitalist_opinion = -5}}
    BLA_check_capitalist_opinion = yes
    BLA = {add_to_variable = {BLA_freeman_opinion = -5}}
    BLA_check_freeman_opinion = yes
    BLA = {add_to_variable = {BLA_serf_opinion = -5}}
    BLA_check_serf_opinion = yes
    }
}
#检测贵族好感
BLA_check_nobility_opinion = {
    if = {
        limit = {
            check_variable = {BLA_nobility_opinion < -100}
        }   
        set_variable = {BLA_nobility_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_nobility_opinion < -75}
            NOT = {has_country_flag = BLA_nobility_plot_triggered}
        }   
        country_event = {id = BLA_pol.999}
        set_country_flag = BLA_nobility_plot_triggered
    }
    if = {
        limit = {
            check_variable = {BLA_nobility_opinion > 100}
        }
        set_variable = {BLA_nobility_opinion = 100}
    }
}
#检测教会好感
BLA_check_church_opinion = {
    if = {
        limit = {
            check_variable = {BLA_church_opinion < -100}
        }
        set_variable = {BLA_church_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_church_opinion > 100}
        }
       set_variable = {BLA_church_opinion = 100}
    }
}
#检测军队好感
BLA_check_army_opinion = {
    if = {
        limit = {
           check_variable = {BLA_army_opinion < -100}
        }
        set_variable = {BLA_army_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_army_opinion > 100}
        }
        set_variable = {BLA_army_opinion = 100}
    }
}
#检测实业家好感
BLA_check_capitalist_opinion = {
    if = {
        limit = {
            check_variable = {BLA_capitalist_opinion < -100}
        }
        set_variable = {BLA_capitalist_opinion = -100}
    }
    if = {
        limit = {
           check_variable = {BLA_capitalist_opinion > 100}
        }
       set_variable = {BLA_capitalist_opinion = 100}
    }
}
#检测自由民好感
BLA_check_freeman_opinion = {
    if = {
        limit = {
            check_variable = {BLA_freeman_opinion < -100}
        }
        set_variable = {BLA_freeman_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_freeman_opinion > 100}
        }
        set_variable = {BLA_freeman_opinion = 100}
    }
}
#检测农奴好感
BLA_check_serf_opinion = {
    if = {
        limit = {
            check_variable = {BLA_serf_opinion < -100}
        }
        set_variable = {BLA_serf_opinion = -100}
    }
    if = {
        limit = {
            check_variable = {BLA_serf_opinion > 20}
        }
        set_variable = {BLA_serf_opinion = 20}
    }
}
#每周变化
BLA_opinion_weekly_change = {
    BLA = {
        add_to_variable = {BLA_nobility_opinion = BLA_nobility_opinion_change}
        add_to_variable = {BLA_church_opinion = BLA_church_opinion_change}
        add_to_variable = {BLA_army_opinion = BLA_army_opinion_change}
        add_to_variable = {BLA_capitalist_opinion = BLA_capitalist_opinion_change}
        add_to_variable = {BLA_freeman_opinion = BLA_freeman_opinion_change}
        add_to_variable = {BLA_serf_opinion = BLA_serf_opinion_change}
        BLA_check_nobility_opinion = yes
        BLA_check_church_opinion = yes
        BLA_check_army_opinion = yes
        BLA_check_capitalist_opinion = yes
        BLA_check_freeman_opinion = yes
        BLA_check_serf_opinion = yes
    }
}
#刷新动态修正
BLA_update_rot = {
    hidden_effect = {
        BLA = {
            set_variable = {BLA_dynamic_stability_factor = BLA_stability_factor}
			set_variable = {BLA_dynamic_political_power_gain = BLA_political_power_gain}
			set_variable = {BLA_dynamic_army_morale_factor = BLA_army_morale_factor}
			set_variable = {BLA_dynamic_army_attack_factor = BLA_army_attack_factor}
			set_variable = {BLA_dynamic_army_defence_factor = BLA_army_defence_factor}
			set_variable = {BLA_dynamic_consumer_goods_factor = BLA_consumer_goods_factor}
            set_variable = {BLA_dynamic_industrial_capacity_factory_2 = BLA_industrial_capacity_factory}
			set_variable = {BLA_dynamic_conscription_factor = BLA_conscription_factor}
			set_variable = {BLA_dynamic_communism_drift = BLA_communism_drift}
			set_variable = {BLA_dynamic_democratic_drift = BLA_democratic_drift}
			multiply_variable = { BLA_dynamic_stability_factor = BLA_nobility_opinion} #贵族
			multiply_variable = { BLA_dynamic_political_power_gain = BLA_church_opinion} #教会
			multiply_variable = { BLA_dynamic_army_morale_factor = BLA_church_opinion} #教会
			multiply_variable = { BLA_dynamic_army_attack_factor = BLA_army_opinion} #军队
			multiply_variable = { BLA_dynamic_army_defence_factor = BLA_army_opinion} #军队
			multiply_variable = { BLA_dynamic_consumer_goods_factor = BLA_capitalist_opinion} #实业家
            multiply_variable = { BLA_dynamic_industrial_capacity_factory_2 = BLA_capitalist_opinion} #实业家
			multiply_variable = { BLA_dynamic_conscription_factor = BLA_freeman_opinion} #自由民
			multiply_variable = { BLA_dynamic_democratic_drift = BLA_serf_opinion} #农奴
			multiply_variable = { BLA_dynamic_communism_drift = BLA_serf_opinion} #农奴
			multiply_variable = { BLA_dynamic_democratic_drift = 0.35} #农奴
			multiply_variable = { BLA_dynamic_communism_drift = 0.65} #农奴
            if = {
                limit = {
                    has_completed_focus = BLA_Anna_reform_7
                }
                add_to_variable = {BLA_dynamic_army_attack_factor = 0.05}
                add_to_variable = {BLA_dynamic_army_defence_factor = 0.05}
            }
        }
    }
}
#随机获得一个把柄
BLA_gain_random_secret = {
    custom_effect_tooltip = BLA_gain_random_secret_desc
    hidden_effect = {
        BLA = {
            random_list = {
                25 = {
                    add_to_variable = {BLA_nobility_secret = 1}
                }
                25 = {
                    add_to_variable = {BLA_church_secret = 1}
                }
                25 = {
                    add_to_variable = {BLA_army_secret = 1}
                }
                25 = {
                    add_to_variable = {BLA_capitalist_secret = 1}
                }
            }
        }
    }
}
#计算贵族税收
BLA_calculate_nobility_tax = {
    if = {
        limit = {
            BLA = {check_variable = {BLA_nobility_opinion > 0}}
        }
        BLA = {
            set_variable = {BLA_nobility_tax = 0}
            set_variable = {BLA_nobility_tax = BLA_nobility_basic_tax}
            multiply_variable = {BLA_nobility_tax = BLA_nobility_opinion}
        }
    }
    if = {
        limit = {
            BLA = {check_variable = {BLA_nobility_tax < 5}}
        }
        BLA = {
            set_variable = {BLA_nobility_tax = 5}
        }
    }
}
#计算教会税收
BLA_calculate_church_tax = {
    if = {
        limit = {
            BLA = {check_variable = {BLA_church_opinion > 0}}
        }
        BLA = {
            set_variable = {BLA_church_tax = 0}
            set_variable = {BLA_church_tax = BLA_church_basic_tax}
            multiply_variable = {BLA_church_tax = BLA_church_opinion}
        }
    }
    else = {
        BLA = {set_variable = {BLA_church_tax = 0}}
    }
}
#计算资本家税收
BLA_calculate_capitalist_tax = {
    if = {
        limit = {
            BLA = {check_variable = {BLA_capitalist_opinion > 0}}
        }
        BLA = {
            set_variable = {BLA_capitalist_tax = 0}
            set_variable = {BLA_capitalist_tax = BLA_capitalist_basic_tax}
            multiply_variable = {BLA_capitalist_tax = BLA_capitalist_opinion}
        }
    }
    if = {
        limit = {
            BLA = {check_variable = {BLA_capitalist_tax < 5}}
        }
        BLA = {
            set_variable = {BLA_capitalist_tax = 5}
        }
    }
}
#结算再投资
BLA_calculate_reinvest = {
    BLA = {
        set_variable = {BLA_revenue = 0}
        set_variable = {BLA_revenue_c = num_of_civilian_factories}
		multiply_variable = {BLA_revenue_c = 0.6}
		set_variable = {BLA_revenue_m = num_of_military_factories}
		multiply_variable = {BLA_revenue_m = 0.2}
		set_variable = {BLA_revenue_d = num_of_naval_factories}
		multiply_variable = {BLA_revenue_d = 0.2}
		add_to_variable = {BLA_revenue = BLA_revenue_c}
		add_to_variable = {BLA_revenue = BLA_revenue_m}
		add_to_variable = {BLA_revenue = BLA_revenue_d}
    }
}
#计算总体债务
BLA_calculate_total_debt = {
    BLA = {
        set_variable = {BLA_debt = 0}
        add_to_variable = {BLA_debt = BLA_other_debt}
        add_to_variable = {BLA_debt = BLA_ELN_debt}
        add_to_variable = {BLA_debt = BLA_ANZ_debt}
        add_to_variable = {BLA_debt = BLA_USR_debt}
        add_to_variable = {BLA_debt = BLA_USF_debt}
        add_to_variable = {BLA_debt = BLA_STG_debt}
        set_variable = {BLA_total_interest = BLA_debt}
		multiply_variable = {BLA_total_interest = 0.01}
    }

}
#计算总体收入
BLA_calculate_total_tax = {
    BLA = {
        add_to_variable = {BLA_industralization_fund = BLA_nobility_tax}
        add_to_variable = {BLA_industralization_fund = BLA_church_tax}
        add_to_variable = {BLA_industralization_fund = BLA_capitalist_tax}
        add_to_variable = {BLA_industralization_fund = BLA_freeman_tax}
        add_to_variable = {BLA_industralization_fund = BLA_serf_tax}
        add_to_variable = {BLA_industralization_fund = BLA_foreign_investment}
        add_to_variable = {BLA_industralization_fund = BLA_extra}
        add_to_variable = {BLA_industralization_fund = BLA_revenue}
        subtract_from_variable = {BLA_industralization_fund = BLA_total_interest}
    }
}
#检测工业化状况
BLA_check_industralization = {
    BLA = {
        if = {
            limit = {
                check_variable = {num_of_factories > BLA_industralization_target}
                check_variable = {BLA_industralization_status < 11}
            }
            BLA_upgrade_industralization = yes
            add_to_variable = {BLA_industralization_target = 10}
        }
    }
}
#提高工业化水平
BLA_upgrade_industralization = {
    BLA = {
        add_to_variable = {BLA_industralization_status = 1}
        add_to_variable = {BLA_dynamic_industrial_capacity_factory = 0.05}
        add_to_variable = {BLA_dynamic_industrial_capacity_dockyard = 0.05}
        add_to_variable = {BLA_dynamic_production_factory_max_efficiency_factor = 0.025}
        add_to_variable = {BLA_dynamic_production_speed_buildings_factor = 0.025}
        add_to_variable = {BLA_dynamic_local_resources_factor = 0.065}
        add_to_variable = {BLA_freeman_tax = 5}
        add_to_variable = {BLA_capitalist_basic_tax = 0.03}
    }
}
#大博弈的结果
Big_Game_result_effect = {
    custom_effect_tooltip = Big_Game_result_effect_desc
    hidden_effect = {
        #给懒狗准备的
        if = {
            limit = {
                NAC = {
                    AND = {
                        NOT = {
                            has_country_flag = Big_Game_E
                        }
                        NOT = {
                            has_country_flag = Big_Game_W
                        }
                        NOT = {
                            has_country_flag = Big_Game_S
                        }
                    }
                }
            }
            NAC = {
                random_list = {
                    33 = {
                        set_country_flag = Big_Game_E
                    }
                    33 = {
                        set_country_flag = Big_Game_W
                    }
                    33 = {
                        set_country_flag = Big_Game_S
                    }
                }
            }
        }
        if = {
            limit = {
                BLA = {
                    AND = {
                        NOT = {
                            has_country_flag = Big_Game_E
                        }
                        NOT = {
                            has_country_flag = Big_Game_W
                        }
                        NOT = {
                            has_country_flag = Big_Game_S
                        }
                    }
                }
            }
            BLA = {
                random_list = {
                    33 = {
                        set_country_flag = Big_Game_E
                    }
                    33 = {
                        set_country_flag = Big_Game_W
                    }
                    33 = {
                        set_country_flag = Big_Game_S
                    }
                }
            }
        }
        if = {
            limit = {
                NAC = {has_country_flag = Big_Game_E}
                BLA = {
                    NOT = {has_country_flag = Big_Game_E}
                }
            }
            every_country = {
                add_to_variable = {NAC_E_control_point = 1}
                add_to_variable = {NAC_E_control_point = NAC_Big_Game_Extra_Point}
            }
        }
        if = {
            limit = {
                NAC = {has_country_flag = Big_Game_S}
                BLA = {
                    NOT = {has_country_flag = Big_Game_S}
                }
            }
            every_country = {
                add_to_variable = {NAC_S_control_point = 1}
                add_to_variable = {NAC_S_control_point = NAC_Big_Game_Extra_Point}
            }
        }
        if = {
            limit = {
                NAC = {has_country_flag = Big_Game_W}
                BLA = {
                    NOT = {has_country_flag = Big_Game_W}
                }
            }
            every_country = {
                add_to_variable = {NAC_W_control_point = 1}
                add_to_variable = {NAC_W_control_point = NAC_Big_Game_Extra_Point}
            }
        }
        if = {
            limit = {
                BLA = {has_country_flag = Big_Game_E}
                NAC = {
                    NOT = {has_country_flag = Big_Game_E}
                }
            }
            every_country = {
                add_to_variable = {BLA_E_control_point = 1}
                add_to_variable = {BLA_E_control_point = BLA_Big_Game_Extra_Point}
            }
        }
        if = {
            limit = {
                BLA = {has_country_flag = Big_Game_S}
                NAC = {
                    NOT = {has_country_flag = Big_Game_S}
                }
            }
            every_country = {
                add_to_variable = {BLA_S_control_point = 1}
                add_to_variable = {BLA_S_control_point = BLA_Big_Game_Extra_Point}
            }
        }
        if = {
            limit = {
                BLA = {has_country_flag = Big_Game_W}
                NAC = {
                    NOT = {has_country_flag = Big_Game_W}
                }
            }
            every_country = {
                add_to_variable = {BLA_W_control_point = 1}
                add_to_variable = {BLA_W_control_point = BLA_Big_Game_Extra_Point}
            }
        }
        if = {
            limit = {
                BLA = {has_country_flag = Big_Game_W}
                NAC = {has_country_flag = Big_Game_W}
            }
            every_country = {
                random_list = {
                    25 = {
                        add_to_variable = {BLA_W_control_point = 2}
                    }
                    25 = {
                        add_to_variable = {BLA_W_control_point = 1}
                    }
                    25 = {
                        add_to_variable = {BLA_W_control_point = -1}
                    }
                    25 = {
                        add_to_variable = {BLA_W_control_point = -2}
                    }
                }
            }
            every_country = {
                random_list = {
                    25 = {
                        add_to_variable = {NAC_W_control_point = 2}
                    }
                    25 = {
                        add_to_variable = {NAC_W_control_point = 1}
                    }
                    25 = {
                        add_to_variable = {NAC_W_control_point = -1}
                    }
                    25 = {
                        add_to_variable = {NAC_W_control_point = -2}
                    }
                }
            }
        }
        if = {
            limit = {
                BLA = {has_country_flag = Big_Game_S}
                NAC = {has_country_flag = Big_Game_S}
            }
            every_country = {
                random_list = {
                    25 = {
                        add_to_variable = {BLA_S_control_point = 2}
                    }
                    25 = {
                        add_to_variable = {BLA_S_control_point = 1}
                    }
                    25 = {
                        add_to_variable = {BLA_S_control_point = -1}
                    }
                    25 = {
                        add_to_variable = {BLA_S_control_point = -2}
                    }
                }
            }
            every_country = {
                random_list = {
                    25 = {
                        add_to_variable = {NAC_S_control_point = 2}
                    }
                    25 = {
                        add_to_variable = {NAC_S_control_point = 1}
                    }
                    25 = {
                        add_to_variable = {NAC_S_control_point = -1}
                    }
                    25 = {
                        add_to_variable = {NAC_S_control_point = -2}
                    }
                }
            }
        }
        if = {
            limit = {
                BLA = {has_country_flag = Big_Game_S}
                NAC = {has_country_flag = Big_Game_S}
            }
            every_country = {
                random_list = {
                    25 = {
                        add_to_variable = {BLA_E_control_point = 2}
                    }
                    25 = {
                        add_to_variable = {BLA_E_control_point = 1}
                    }
                    25 = {
                        add_to_variable = {BLA_E_control_point = -1}
                    }
                    25 = {
                        add_to_variable = {BLA_E_control_point = -2}
                    }
                }
            }
            every_country = {
                random_list = {
                    25 = {
                        add_to_variable = {NAC_E_control_point = 2}
                    }
                    25 = {
                        add_to_variable = {NAC_E_control_point = 1}
                    }
                    25 = {
                        add_to_variable = {NAC_E_control_point = -1}
                    }
                    25 = {
                        add_to_variable = {NAC_E_control_point = -2}
                    }
                }
            }
        }
        if = {
            limit = {
                BLA = {
                    communism < 0.05
                }
            }
            every_country = {
                add_to_variable = {BLA_E_control_point = 0.20}
                add_to_variable = {BLA_W_control_point = 0.20}
                add_to_variable = {BLA_S_control_point = 0.20}
            }
        }
        if = {
            limit = {
                BLA = {
                    communism > 0.30
                }
            }
            every_country = {
                add_to_variable = {NAC_E_control_point = 0.75}
                add_to_variable = {NAC_W_control_point = 0.75}
                add_to_variable = {NAC_S_control_point = 0.75}
            }
        }
        else_if = {
            limit = {
                BLA = {
                    communism > 0.25
                }
            }
            every_country = {
                add_to_variable = {NAC_E_control_point = 0.50}
                add_to_variable = {NAC_W_control_point = 0.50}
                add_to_variable = {NAC_S_control_point = 0.50}
            }
        }
        else_if = {
            limit = {
                BLA = {
                    communism > 0.20
                }
            }
            every_country = {
                add_to_variable = {NAC_E_control_point = 0.3}
                add_to_variable = {NAC_W_control_point = 0.3}
                add_to_variable = {NAC_S_control_point = 0.3}
            }
        }
        else_if = {
            limit = {
                BLA = {
                    communism > 0.15
                }
            }
            every_country = {
                add_to_variable = {NAC_E_control_point = 0.2}
                add_to_variable = {NAC_W_control_point = 0.2}
                add_to_variable = {NAC_S_control_point = 0.2}
            }
        }
        every_country = {
            clamp_variable = {
                var = NAC_W_control_point
                min = 0
            }
            clamp_variable = {
                var = NAC_S_control_point
                min = 0
            }
            clamp_variable = {
                var = NAC_E_control_point
                min = 0
            }
            clr_country_flag = Big_Game_W
            clr_country_flag = Big_Game_S
            clr_country_flag = Big_Game_E
            clr_country_flag = Extra_input_flag
            clr_country_flag = Made_a_choice_in_Big_Game
            set_variable = {NAC_Big_Game_Extra_Point = 0}
        }
        every_country = {
            clamp_variable = {
                var = BLA_W_control_point
                min = 0
            }
            clamp_variable = {
                var = BLA_S_control_point
                min = 0
            }
            clamp_variable = {
                var = BLA_E_control_point
                min = 0
            }
            clr_country_flag = Big_Game_W
            clr_country_flag = Big_Game_S
            clr_country_flag = Big_Game_E
            clr_country_flag = Extra_input_flag
            clr_country_flag = Made_a_choice_in_Big_Game
            set_variable = {BLA_Big_Game_Extra_Point = 0}
        }
    }
}
Rossiya_Revolution_NAC_army_effect = {
    hidden_effect = {
        NAC = {
            if = {
                limit = {
                    NOT = {
                        has_template = "真理解放军"
                    }
                }
                division_template = {
                    name = "真理解放军"
                    is_locked = no
                    priority = 0
                    regiments = {
                        infantry = { x = 0 y = 0 }
                        infantry = { x = 0 y = 1 }
                        infantry = { x = 1 y = 0 }
                        infantry = { x = 1 y = 1 }
                        infantry = { x = 2 y = 0 }
                        infantry = { x = 2 y = 1 }
                    }
                }
            }
            if = {
                limit = {
                    NOT = {
                        has_template = "罗西亚红军"
                    }
                }
                division_template = {
                    name = "罗西亚红军"
                    regiments = {
                        infantry = { x = 0 y = 0 }
                        infantry = { x = 0 y = 1 }
                        infantry = { x = 0 y = 2 }
                        infantry = { x = 1 y = 0 }
                        infantry = { x = 1 y = 1 }
                        infantry = { x = 1 y = 2 }
                        artillery_brigade = { x = 2 y = 0 }
                    }
                }
            }
            if = {
                limit = {
                    NOT = {
                        has_template = "自由农民旅"
                    }
                }
                division_template = {
                    name = "自由农民旅"
                    is_locked = no
                    priority = 0
                    template_counter = 0
                    regiments = {
                        militia = { x = 0 y = 0 }
                        militia = { x = 0 y = 1 }
                        militia = { x = 0 y = 2 }
                        militia = { x = 1 y = 0 }
                    }
                }
            }
        }
        create_unit = {
            division = "name = \"真理解放军\" division_template = \"真理解放军\" start_experience_factor = 0.15"
            owner = NAC
        }
        create_unit = {
            division = "name = \"真理解放军\" division_template = \"真理解放军\" start_experience_factor = 0.15"
            owner = NAC
        }
        create_unit = {
            division = "name = \"罗西亚红军\" division_template = \"罗西亚红军\" start_experience_factor = 0.25"
            owner = NAC
        }
		create_unit = {
            division = "name = \"罗西亚红军\" division_template = \"罗西亚红军\" start_experience_factor = 0.25"
            owner = NAC
        }
        create_unit = {
            division = "name = \"自由农民旅\" division_template = \"自由农民旅\" start_experience_factor = 0.25"
            owner = NAC
        }
        if = {
            limit = {
                BLA = {has_idea = BLA_serfdom}
            }
            create_unit = {
                division = "name = \"自由农民旅\" division_template = \"自由农民旅\" start_experience_factor = 0.25"
                owner = NAC
            }
        }
    }
}
Rossiya_Revolution_ORE_army_effect = {
    hidden_effect = {
        ORE = {
            if = {
                limit = {
                    NOT = {
                        has_template = "奥伦堡民兵"
                    }
                }
                division_template = {
                    name = "奥伦堡民兵"
                    is_locked = no
                    priority = 0
                    regiments = {
                        infantry = { x = 0 y = 0 }
                        infantry = { x = 0 y = 1 }
                        infantry = { x = 1 y = 0 }
                        infantry = { x = 1 y = 1 }
                        infantry = { x = 2 y = 0 }
                        infantry = { x = 2 y = 1 }
                        artillery_brigade = {x = 3 y = 0}
                    }
                }
            }
            if = {
                limit = {
                    NOT = {
                        has_template = "自由农民旅"
                    }
                }
                division_template = {
                    name = "自由农民旅"
                    is_locked = no
                    priority = 0
                    template_counter = 0
                    regiments = {
                        militia = { x = 0 y = 0 }
                        militia = { x = 0 y = 1 }
                        militia = { x = 0 y = 2 }
                        militia = { x = 1 y = 0 }
                    }
                }
            }
        }
        create_unit = {
            division = "name = \"奥伦堡民兵\" division_template = \"奥伦堡民兵\" start_experience_factor = 0.75"
            owner = ORE
        }
        create_unit = {
            division = "name = \"奥伦堡民兵\" division_template = \"奥伦堡民兵\" start_experience_factor = 0.75"
            owner = ORE
        }
        create_unit = {
            division = "name = \"奥伦堡民兵\" division_template = \"奥伦堡民兵\" start_experience_factor = 0.75"
            owner = ORE
        }
        create_unit = {
            division = "name = \"奥伦堡民兵\" division_template = \"奥伦堡民兵\" start_experience_factor = 0.75"
            owner = ORE
        }
        create_unit = {
            division = "name = \"奥伦堡民兵\" division_template = \"奥伦堡民兵\" start_experience_factor = 0.75"
            owner = ORE
        }
		create_unit = {
            division = "name = \"自由农民旅\" division_template = \"自由农民旅\" start_experience_factor = 0.15"
            owner = ORE
        }
        create_unit = {
            division = "name = \"自由农民旅\" division_template = \"自由农民旅\" start_experience_factor = 0.15"
            owner = ORE
        }
        if = {
            limit = {
                BLA = {has_idea = BLA_serfdom}
            }
            create_unit = {
                division = "name = \"自由农民旅\" division_template = \"自由农民旅\" start_experience_factor = 0.15"
                owner = ORE
            }
        }
    }
}
Rossiya_Revolution_Map_effect = {
    custom_effect_tooltip = Big_GAME_END_DESC
    hidden_effect = {
        1 = {
            Rossiya_Revolution_NAC_army_effect = yes
        }
        76 = {
            Rossiya_Revolution_NAC_army_effect = yes
        }
        if = {
            limit = {
                BLA = {
                    check_variable = {
                        var = NAC_W_control_point
                        value = BLA_W_control_point
                        compare = greater_than_or_equals
                    }
                }
            }
            146 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
            194 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
            123 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
            208 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
        }
        else = {
            146 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
            194 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
        }
        if = {
            limit = {
                BLA = {
                    check_variable = {
                        var = NAC_S_control_point
                        value = BLA_S_control_point
                        compare = greater_than_or_equals
                    }
                }
            }
            265 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
                Rossiya_Revolution_NAC_army_effect = yes
            }
            256 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
            248 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
        }
        else = {
            265 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
                Rossiya_Revolution_NAC_army_effect = yes
            }
            256 = {
                transfer_state_to = NAC
                Rossiya_Revolution_NAC_army_effect = yes
            }
        }
        if = {
            limit = {
                BLA = {
                    check_variable = {
                        var = NAC_E_control_point
                        value = BLA_E_control_point
                        compare = greater_than_or_equals
                    }
                }
            }
            106 = {
                transfer_state_to = ORE
                add_core_of = ORE
                Rossiya_Revolution_ORE_army_effect = yes
            }
            111 = {
                transfer_state_to = ORE
                add_core_of = ORE
                Rossiya_Revolution_NAC_army_effect = yes
            }
        }
        else = {
            106 = {
                transfer_state_to = ORE
                add_core_of = ORE
                Rossiya_Revolution_ORE_army_effect = yes
            }
        }
        NAC = {
            country_lock_all_division_template = no
            if = {
                limit = {
                    BLA = {check_variable = {BLA_serf_opinion < -75}}
                }
                NAC = {add_to_variable = {NAC_morale = 5}}
            }
            if = {
                limit = {
                    BLA = {check_variable = {BLA_serf_opinion < -50}}                    
                }
                NAC = {add_to_variable = {NAC_morale = 5}}
            }
            if = {
                limit = {
                    BLA = {check_variable = {BLA_serf_opinion < -25}}
                }
                NAC = {add_to_variable = {NAC_morale = 5}}
            }
            if = {
                limit = {
                    BLA = {check_variable = {BLA_serf_opinion < 0}}
                }
                NAC = {add_to_variable = {NAC_morale = 5}}
            }
            if = {
                limit = {
                    BLA = {check_variable = {BLA_serf_opinion > 0}}
                }
                NAC = {add_to_variable = {NAC_morale = -20}}
            }
            if = {
                limit = {
                    BLA = {check_variable = {BLA_army_opinion < 25}}
                }
                NAC = {add_to_variable = {NAC_morale = 5}}
                }
            if = {
                limit = {
                    BLA = {check_variable = {BLA_army_opinion < 0}}
                }
                NAC = {add_to_variable = {NAC_morale = 10}}
            }
            if = {
                limit = {
                    BLA = {check_variable = {BLA_freeman_opinion < 25}}
                }
                NAC = {add_to_variable = {NAC_morale = 5}}
            }
            if = {
                limit = {
                    BLA = {check_variable = {BLA_freeman_opinion < 0}}
                }
                NAC = {add_to_variable = {NAC_morale = 10}}
            }
        }
        ORE = {
            add_ideas = ORE_revolution_in_city
            set_politics = {
                ruling_party = communism
            }
            set_political_party = {
                ideology = communism
                popularity = 100
            }
            promote_character = {
                character = ORE_Valeri
                ideology = sub_democratic_socialism
            }
        }
    }
}
#大博弈的最终结果
End_Big_Game = {
    set_global_flag = End_Big_Game_flag
    if = {
        limit = {
            BLA = {
                check_variable = {
                    var = NAC_W_control_point
                    value = BLA_W_control_point
                    compare = greater_than_or_equals
                }
            }
        }
        every_country = {
            add_to_variable = {NAC_VP = 1}
        }
    }
    else = {
        every_country = {
            add_to_variable = {BLA_VP = 1}
        }
    }
    if = {
        limit = {
            BLA = {
                check_variable = {
                    var = NAC_E_control_point
                    value = BLA_E_control_point
                    compare = greater_than_or_equals
                }
            }
        }
        every_country = {
            add_to_variable = {NAC_VP = 1}
        }
    }
    else = {
        every_country = {
            add_to_variable = {BLA_VP = 1}
        }
    }
    if = {
        limit = {
            BLA = {
                check_variable = {
                    var = NAC_S_control_point
                    value = BLA_S_control_point
                    compare = greater_than_or_equals
                }
            }
        }
        every_country = {
            add_to_variable = {NAC_VP = 1}
        }
    }
    else = {
        every_country = {
            add_to_variable = {BLA_VP = 1}
        }
    }
    NAC = {
        if = {
            limit = {
                check_variable = {NAC_VP = 0}
            }
            add_ideas = Big_Game_Total_Loser
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = 5000
                producer = BLA
            }
            add_equipment_to_stockpile = {
                type = artillery_equipment
                amount = 300
                producer = BLA
            }
        }
        else_if = {
            limit = {
                check_variable = {NAC_VP = 1}
            }
            add_ideas = Big_Game_Loser
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = 10000
                producer = BLA
            }
            add_equipment_to_stockpile = {
                type = artillery_equipment
                amount = 600
                producer = BLA
            }
        }
        else_if = {
            limit = {
                check_variable = {NAC_VP = 2}
            }
            add_ideas = Big_Game_Winner
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = 15000
                producer = BLA
            }
            add_equipment_to_stockpile = {
                type = artillery_equipment
                amount = 900
                producer = BLA
            }
        }
        else = {
            add_ideas = Big_Game_Total_Winner
            add_equipment_to_stockpile = {
                type = infantry_equipment
                amount = 20000
                producer = BLA
            }
            add_equipment_to_stockpile = {
                type = artillery_equipment
                amount = 1500
                producer = BLA
            }
        }
    }
    BLA = {
        if = {
            limit = {
                check_variable = {BLA_VP = 0}
            }
            add_ideas = Big_Game_Total_Loser
        }
        else_if = {
            limit = {
                check_variable = {BLA_VP = 1}
            }
            add_ideas = Big_Game_Loser
        }
        else_if = {
            limit = {
                check_variable = {BLA_VP = 2}
            }
            add_ideas = Big_Game_Winner
        }
        else = {
            add_ideas = Big_Game_Total_Winner
        }
    }
}
Clear_Big_Game_ideas = {
    hidden_effect = {
        remove_ideas = Big_Game_Total_Loser
        remove_ideas = Big_Game_Loser
        remove_ideas = Big_Game_Winner
        remove_ideas = Big_Game_Total_Winner
    }
}
Big_Game_Test = {
    hidden_effect = {
        every_country = {
            add_to_variable = {NAC_S_control_point = 100}
            add_to_variable = {NAC_W_control_point = 100}
            add_to_variable = {NAC_E_control_point = 100}
        }
    }
}
BLA_bop_move_leftward = {
    add_power_balance_value = {
        id = BLA_legacy_of_August
        value = -0.05
        tooltip_side = BLA_voice_of_people
    }
}
BLA_bop_move_leftward_big = {
    add_power_balance_value = {
        id = BLA_legacy_of_August
        value = -0.10
        tooltip_side = BLA_voice_of_people
    }
}
BLA_bop_move_rightward = {
    add_power_balance_value = {
        id = BLA_legacy_of_August
        value = 0.05
        tooltip_side = BLA_ice_dream
    }
}
BLA_bop_move_rightward_big = {
    add_power_balance_value = {
        id = BLA_legacy_of_August
        value = 0.10
        tooltip_side = BLA_ice_dream
    }
}
BLA_update_revolution_dynamic_modifier = {
    BLA = {
        if = {
            limit = {
                has_war_with = NAC
                NOT = {check_variable = {BLA_morale < -99}}
            }
            add_to_variable = {BLA_morale = -1}
            if = {
                limit = {
                    check_variable = {BLA_nobility_opinion > 59}
                }
                add_to_variable = {BLA_morale = 0.1}
            }
            if = {
                limit = {
                    check_variable = {BLA_church_opinion > 59}
                }
                add_to_variable = {BLA_morale = 0.1}
            }
            if = {
                limit = {
                    check_variable = {BLA_army_opinion > 59}
                }
                add_to_variable = {BLA_morale = 0.1}
            }
            if = {
                limit = {
                    check_variable = {BLA_freeman_opinion > 59}
                }
                add_to_variable = {BLA_morale = 0.15}
            }
            if = {
                limit = {
                    check_variable = {BLA_capitalist_opinion > 59}
                }
                add_to_variable = {BLA_morale = 0.1}
            }
            if = {
                limit = {
                    check_variable = {BLA_serf_opinion > 0}
                }
                add_to_variable = {BLA_morale = 0.15}
            }
            if = {
                limit = {
                    check_variable = {BLA_serf_opinion < 0}
                }
                add_to_variable = {BLA_morale = -0.15}
            }
        }
        NAC = {
            if = {
                limit = {
                    surrender_progress > 0.79
                }
                BLA = {add_to_variable = {BLA_morale = 0.25}}
            }
            if = {
                limit = {
                    surrender_progress > 0.59
                }
                BLA = {add_to_variable = {BLA_morale = 0.25}}
            }
            if = {
                limit = {
                    surrender_progress > 0.39
                }
                BLA = {add_to_variable = {BLA_morale = 0.25}}
            }
            if = {
                limit = {
                    surrender_progress > 0.19
                }
                BLA = {add_to_variable = {BLA_morale = 0.25}}
            }
        }
        clamp_variable = {
            var = BLA_morale
            max = 120
            min = -100
        }
        set_variable = {BLA_revolution_dynamic_army_attack_factor = BLA_army_attack_factor}
        set_variable = {BLA_revolution_dynamic_army_defence_factor = BLA_army_defence_factor}
        set_variable = {BLA_revolution_dynamic_army_morale_factor = BLA_army_morale_factor}
        set_variable = {BLA_revolution_dynamic_army_org_factor = BLA_army_org_factor}
        set_variable = {BLA_revolution_dynamic_equipment_capture_factor = BLA_equipment_capture_factor}
        set_variable = {BLA_revolution_dynamic_land_reinforce_rate = BLA_land_reinforce_rate}
        multiply_variable = {BLA_revolution_dynamic_army_attack_factor = BLA_morale}
        multiply_variable = {BLA_revolution_dynamic_army_defence_factor = BLA_morale}
        multiply_variable = {BLA_revolution_dynamic_army_morale_factor = BLA_morale}
        multiply_variable = {BLA_revolution_dynamic_army_org_factor = BLA_morale}
        multiply_variable = {BLA_revolution_dynamic_land_reinforce_rate = BLA_morale}
    }
}