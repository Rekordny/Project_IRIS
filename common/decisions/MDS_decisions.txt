#风之低语
MDS_whisper_cate = {
	#巡风探报
	MDS_whisper_tec = {
		allowed = {
			original_tag = MDS
		}
		visible = {
			has_idea = MDS_whisper
		}
		available = {
			custom_trigger_tooltip = {
                tooltip = MDS_whisper_more_than_0
				check_variable = {
                    MDS_whisper_point > 0
                }
            }
		}
		fire_only_once = no
		complete_effect = {
			subtract_from_variable = {
                MDS_whisper_point = 1
            }
			if = {
				limit = {
					has_idea = MDS_Rosaria
				}
				effect_tooltip = {
					random_list = {
						20 = {
							custom_effect_tooltip = MDS_whisper_tec_inf_and_support_improve
						}
						20 = {
							custom_effect_tooltip = MDS_whisper_tec_art_and_tank_improve
						}
						20 = {
							custom_effect_tooltip = MDS_whisper_tec_ind_improve
						}
					}
				}
				hidden_effect = {
					random_list = {
						20 = {
							add_tech_bonus = {
								bonus = 0.75
								uses = 1
								category = infantry_weapons
								category = support_tech
							}
							add_tech_bonus = {
								bonus = 0.25
								uses = 1
								category = infantry_weapons
								category = support_tech
							}
							random_list = {
								20 = {
									add_tech_bonus = {
										bonus = 0.75
										uses = 1
										category = armor
										category = artillery
										category = motorized_equipment
									}
									add_tech_bonus = {
										bonus = 0.25
										uses = 1
										category = armor
										category = artillery
										category = motorized_equipment
									}
								}
								20 = {
									add_tech_bonus = {
										bonus = 0.75
										uses = 1
										category = industry
										category = electronics
									}
									add_tech_bonus = {
										bonus = 0.25
										uses = 1
										category = industry
										category = electronics
									}
								}
							}
						}
						20 = {
							add_tech_bonus = {
								bonus = 0.75
								uses = 1
								category = armor
								category = artillery
								category = motorized_equipment
							}
							add_tech_bonus = {
								bonus = 0.25
								uses = 1
								category = armor
								category = artillery
								category = motorized_equipment
							}
							random_list = {
								20 = {
									add_tech_bonus = {
										bonus = 0.75
										uses = 1
										category = infantry_weapons
										category = support_tech
									}
									add_tech_bonus = {
										bonus = 0.25
										uses = 1
										category = infantry_weapons
										category = support_tech
									}
								}
								20 = {
									add_tech_bonus = {
										bonus = 0.75
										uses = 1
										category = industry
										category = electronics
									}
									add_tech_bonus = {
										bonus = 0.25
										uses = 1
										category = industry
										category = electronics
									}
								}
							}
						}
						20 = {
							add_tech_bonus = {
								bonus = 0.75
								uses = 1
								category = industry
								category = electronics
							}
							add_tech_bonus = {
								bonus = 0.25
								uses = 1
								category = industry
								category = electronics
							}
							random_list = {
								20 = {
									add_tech_bonus = {
										bonus = 0.75
										uses = 1
										category = infantry_weapons
										category = support_tech
									}
									add_tech_bonus = {
										bonus = 0.25
										uses = 1
										category = infantry_weapons
										category = support_tech
									}
								}
								20 = {
									add_tech_bonus = {
										bonus = 0.75
										uses = 1
										category = armor
										category = artillery
										category = motorized_equipment
									}
									add_tech_bonus = {
										bonus = 0.25
										uses = 1
										category = armor
										category = artillery
										category = motorized_equipment
									}
								}
							}
						}
					}
				}
			}
			else = {
				effect_tooltip = {
					random_list = {
						20 = {
							custom_effect_tooltip = MDS_whisper_tec_inf_and_support
						}
						20 = {
							custom_effect_tooltip = MDS_whisper_tec_art_and_tank
						}
						20 = {
							custom_effect_tooltip = MDS_whisper_tec_ind
						}
					}
				}
				hidden_effect = {
					random_list = {
						20 = {
							add_tech_bonus = {
								bonus = 0.75
								uses = 1
								category = infantry_weapons
								category = support_tech
							}
							add_tech_bonus = {
								bonus = 0.25
								uses = 1
								category = infantry_weapons
								category = support_tech
							}
						}
						20 = {
							add_tech_bonus = {
								bonus = 0.75
								uses = 1
								category = armor
								category = artillery
								category = motorized_equipment
							}
							add_tech_bonus = {
								bonus = 0.25
								uses = 1
								category = armor
								category = artillery
								category = motorized_equipment
							}
						}
						20 = {
							add_tech_bonus = {
								bonus = 0.75
								uses = 1
								category = industry
								category = electronics
							}
							add_tech_bonus = {
								bonus = 0.25
								uses = 1
								category = industry
								category = electronics
							}
						}
					}
				}
			}
		}
		ai_will_do = {
			#TODO
            base = 0
		}
	}

	#隐匠造甲
	MDS_whisper_mic = {
		allowed = {
			original_tag = MDS
		}
		visible = {
			has_idea = MDS_whisper
		}
		available = {
			custom_trigger_tooltip = {
                tooltip = MDS_whisper_more_than_0
				check_variable = {
                    MDS_whisper_point > 0
                }
            }
		}
		fire_only_once = no
		complete_effect = {
			subtract_from_variable = {
                MDS_whisper_point = 1
            }
			if = {
				limit = {
					has_idea = MDS_Wagner
				}
				add_to_variable = {
					MDS_whisper_mic_nm = 2
				}
				custom_effect_tooltip = MDS_whisper_mic_improve_tt
			}
			else = {
				add_to_variable = {
					MDS_whisper_mic_nm = 1
				}
				custom_effect_tooltip = MDS_whisper_mic_tt
			}
		}
		ai_will_do = {
			#TODO
            base = 0
		}
	}

	#诗酒凝心
	MDS_whisper_man = {
		allowed = {
			original_tag = MDS
		}
		visible = {
			has_idea = MDS_whisper
		}
		available = {
			custom_trigger_tooltip = {
                tooltip = MDS_whisper_more_than_0
				check_variable = {
                    MDS_whisper_point > 0
                }
            }
		}
		fire_only_once = no
		complete_effect = {
			subtract_from_variable = {
                MDS_whisper_point = 1
            }
			custom_effect_tooltip = MDS_whisper_man_tt
            add_to_variable = {
				MDS_whisper_man_nm = MDS_whisper_man_gain
			}
			if = {
				limit = {
					check_variable = {
						MDS_whisper_man_train < 100
					}
				}
				add_to_variable = {
					MDS_whisper_man_train = MDS_whisper_man_train_gain
				}
				clamp_variable = {
					var = MDS_whisper_man_train 
					max = 100
				}
			}
		}
		ai_will_do = {
			#TODO
            base = 0
		}
	}

	#动用隐匿武器保卫国家
	MDS_add_weapon_to_stockpile = {
		allowed = {
			original_tag = MDS
		}
		visible = {
			has_idea = MDS_whisper
			has_war = yes
		}
		available = {
			has_war = yes
			custom_trigger_tooltip = {
				tooltip = MDS_weapon_more_than_one
				OR = {
					check_variable = {
						MDS_whisper_inf_nm > 0
					}
					check_variable = {
						MDS_whisper_sup_nm > 0
					}
					check_variable = {
						MDS_whisper_art_nm > 0
					}
					check_variable = {
						MDS_whisper_ant_nm > 0
					}
					check_variable = {
						MDS_whisper_ana_nm > 0
					}
					check_variable = {
						MDS_whisper_lit_nm > 0
					}
					check_variable = {
						MDS_whisper_mot_nm > 0
					}
				}
			}
		}

		fire_only_once = no
		days_re_enable = 180

		complete_effect = {
			custom_effect_tooltip = MDS_add_weapon_to_stockpile_tt
			hidden_effect = {
				if = {
					limit = {
						check_variable = {
							MDS_whisper_lit_nm > 0
						}
						NOT = {
							has_country_flag = MDS_add_weapon_to_stockpile
						}
					}
					create_equipment_variant = {
						name = "Panzer II Ausf. M"
						type = light_tank_chassis_2
						allow_without_tech = yes
						parent_version = 0
						modules = {
							main_armament_slot = tank_small_cannon_2
							turret_type_slot = tank_light_three_man_tank_turret
							suspension_type_slot = tank_christie_suspension
							armor_type_slot = tank_riveted_armor
							engine_type_slot = tank_gasoline_engine
							special_type_slot_1 = tank_radio_1
							special_type_slot_2 = secondary_turret_hmg
							special_type_slot_3 = additional_machine_guns
							special_type_slot_4 = empty
						}
						upgrades = {
							tank_nsb_engine_upgrade = 0
							tank_nsb_armor_upgrade = 0
						}
						icon = "GFX_GER_improved_light_tank_medium"
						model = "GER_light_armor_entity"
					}
					set_country_flag = MDS_add_weapon_to_stockpile
				}
			}
			hidden_effect = {
				set_temp_variable = {
					MDS_whisper_inf_nm_temp = MDS_whisper_inf_nm
				}
				multiply_temp_variable = {
					MDS_whisper_inf_nm_temp = 0.5
				}
				round_temp_variable = MDS_whisper_inf_nm_temp
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = MDS_whisper_inf_nm_temp
					producer = USR
				}
				set_variable = {
					MDS_whisper_inf_nm = MDS_whisper_inf_nm_temp
				}
				set_temp_variable = {
					MDS_whisper_sup_nm_temp = MDS_whisper_sup_nm
				}
				multiply_temp_variable = {
					MDS_whisper_sup_nm_temp = 0.5
				}
				round_temp_variable = MDS_whisper_sup_nm_temp
				add_equipment_to_stockpile = {
					type = support_equipment 
					amount = MDS_whisper_sup_nm_temp
					producer = USR
				}
				set_variable = {
					MDS_whisper_sup_nm = MDS_whisper_sup_nm_temp
				}
				set_temp_variable = {
					MDS_whisper_art_nm_temp = MDS_whisper_art_nm
				}
				multiply_temp_variable = {
					MDS_whisper_art_nm_temp = 0.5
				}
				round_temp_variable = MDS_whisper_art_nm_temp
				add_equipment_to_stockpile = {
					type = artillery_equipment  
					amount = MDS_whisper_art_nm_temp
					producer = USR
				}
				set_variable = {
					MDS_whisper_art_nm = MDS_whisper_art_nm_temp
				}
				set_temp_variable = {
					MDS_whisper_ant_nm_temp = MDS_whisper_ant_nm
				}
				multiply_temp_variable = {
					MDS_whisper_ant_nm_temp = 0.5
				}
				round_temp_variable = MDS_whisper_ant_nm_temp
				add_equipment_to_stockpile = {
					type = anti_tank_equipment  
					amount = MDS_whisper_ant_nm_temp
					producer = USR
				}
				set_variable = {
					MDS_whisper_ant_nm = MDS_whisper_ant_nm_temp
				}
				set_temp_variable = {
					MDS_whisper_ana_nm_temp = MDS_whisper_ana_nm
				}
				multiply_temp_variable = {
					MDS_whisper_ana_nm_temp = 0.5
				}
				round_temp_variable = MDS_whisper_ana_nm_temp
				add_equipment_to_stockpile = {
					type = anti_air_equipment  
					amount = MDS_whisper_ana_nm_temp
					producer = USR
				}
				set_variable = {
					MDS_whisper_ana_nm = MDS_whisper_ana_nm_temp
				}
				set_temp_variable = {
					MDS_whisper_lit_nm_temp = MDS_whisper_lit_nm
				}
				multiply_temp_variable = {
					MDS_whisper_lit_nm_temp = 0.5
				}
				round_temp_variable = MDS_whisper_lit_nm_temp
				add_equipment_to_stockpile = {
					type = light_tank_chassis_2 
					amount = MDS_whisper_lit_nm_temp
					variant_name = "Panzer II Ausf. M"
				}
				set_variable = {
					MDS_whisper_lit_nm = MDS_whisper_lit_nm_temp
				}
				set_temp_variable = {
					MDS_whisper_mot_nm_temp = MDS_whisper_mot_nm
				}
				multiply_temp_variable = {
					MDS_whisper_mot_nm_temp = 0.5
				}
				round_temp_variable = MDS_whisper_mot_nm_temp
				add_equipment_to_stockpile = {
					type = motorized_equipment  
					amount = MDS_whisper_mot_nm_temp
					producer = USR
				}
				set_variable = {
					MDS_whisper_mot_nm = MDS_whisper_mot_nm_temp
				}
			}
		}
		ai_will_do = {
			#TODO
            base = 0
		}
	}

	#动员爱国者保卫国家
	MDS_add_manpower = {
		allowed = {
			original_tag = MDS
		}
		visible = {
			has_idea = MDS_whisper
			has_war = yes
		}
		available = {
			has_war = yes
			custom_trigger_tooltip = {
				tooltip = MDS_manpower_more_than_one
				check_variable = {
					MDS_whisper_man_nm > 0
				}
			}
		}

		fire_only_once = no
		days_re_enable = 180

		complete_effect = {
			custom_effect_tooltip = MDS_add_manpower_tt
			hidden_effect = {
				set_temp_variable = {
					MDS_whisper_man_nm_temp = MDS_whisper_man_nm
				}
				multiply_temp_variable = {
					MDS_whisper_man_nm_temp = 0.5
				}
				add_manpower = MDS_whisper_man_nm_temp
				set_variable = {
					MDS_whisper_man_nm = MDS_whisper_man_nm_temp
				}
			}
		}
		ai_will_do = {
			#TODO
            base = 0
		}
	}

	MDS_debug_add_point = {
		allowed = {
			original_tag = MDS
		}
		visible = {
			has_idea = MDS_whisper
			is_debug = yes
		}
		fire_only_once = no
		complete_effect = {
			add_to_variable = {
                MDS_whisper_point = 10
            }
			add_to_variable = {
				MDS_whisper_mic_nm = 10
			}
		}
		ai_will_do = {
			#TODO
            base = 0
		}
	}

	MDS_debug_add_weapon_to_stockpile = {
		allowed = {
			original_tag = MDS
		}
		visible = {
			has_idea = MDS_whisper
			is_debug = yes
		}
		fire_only_once = no
		complete_effect = {
			if = {
				limit = {
					check_variable = {
						MDS_whisper_lit_nm > 0
					}
					NOT = {
						has_country_flag = MDS_add_weapon_to_stockpile
					}
				}
				create_equipment_variant = {
					name = "Panzer II Ausf. M"
					type = light_tank_chassis_2
					allow_without_tech = yes
					parent_version = 0
					modules = {
						main_armament_slot = tank_small_cannon_2
						turret_type_slot = tank_light_three_man_tank_turret
						suspension_type_slot = tank_christie_suspension
						armor_type_slot = tank_riveted_armor
						engine_type_slot = tank_gasoline_engine
						special_type_slot_1 = tank_radio_1
						special_type_slot_2 = secondary_turret_hmg
						special_type_slot_3 = additional_machine_guns
						special_type_slot_4 = empty
					}
					upgrades = {
						tank_nsb_engine_upgrade = 0
						tank_nsb_armor_upgrade = 0
					}
					icon = "GFX_GER_improved_light_tank_medium"
					model = "GER_light_armor_entity"
				}
				set_country_flag = MDS_add_weapon_to_stockpile
			}
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = MDS_whisper_inf_nm
				producer = USR
			}
			add_equipment_to_stockpile = {
				type = support_equipment 
				amount = MDS_whisper_sup_nm
				producer = USR
			}
			add_equipment_to_stockpile = {
				type = artillery_equipment  
				amount = MDS_whisper_art_nm
				producer = USR
			}
			add_equipment_to_stockpile = {
				type = anti_tank_equipment  
				amount = MDS_whisper_ant_nm
				producer = USR
			}
			add_equipment_to_stockpile = {
				type = anti_air_equipment  
				amount = MDS_whisper_ana_nm
				producer = USR
			}
			add_equipment_to_stockpile = {
				type = light_tank_chassis_2 
				amount = MDS_whisper_lit_nm
				variant_name = "Panzer II Ausf. M"
			}
			add_equipment_to_stockpile = {
				type = motorized_equipment  
				amount = MDS_whisper_mot_nm
				producer = USR
			}
		}
		ai_will_do = {
			#TODO
            base = 0
		}
	}
}