on_actions = {
	on_startup = {
		effect = {

			USF = {

				#初始化干涉大洋
				POC_setup_influence = yes

				#防止变成幽灵部队
				load_oob = "USF"
				load_oob = "USF_naval"
				load_oob = "USF_air"
				add_manpower = 50000


				if = {
					limit = {
						#always = no #没做完捏
						always = yes
					}
					activate_mission = USF_cut_naval_budget_decision
					activate_mission = USF_impose_excess_profits_tax_decision
					activate_mission = USF_cut_defense_cost_decision
					activate_mission = USF_destory_extra_products_decision
					activate_mission = USF_election_result
				}

				if = {
					limit = {
						is_ai = yes
					}
					add_political_power = 250
					country_event = {id = USF_temp.3 days = 400}
					country_event = {id = USF_temp.4 days = 700}
					country_event = {id = USF_temp.5 days = 1000}
				}

				#country_event = {id = USF.2 days = 3}
				country_event = {id = USF_flavor.1 days = 42}
				country_event = {id = USF_flavor.2 days = 520}
				country_event = {id = USF_flavor.4 days = 805}
				country_event = {id = USF.8 days = 14}
				country_event = {id = USF.14 days = 90}
				country_event = {id = NSJ.1 days = 1000}
				country_event = {id = USF_kay.1 days = 330}
				country_event = {id = LUA.1 days = 21}
				USF_test_line = yes
				USF_pandemic_setup = yes
				USF_update_leverage_republic = yes

				if = {
					limit = {
						always = no
					}
					#骨架事件
					country_event = {id = USF_temp.1 days = 365}
					country_event = {id = USF_temp.2 days = 680}
					country_event = {id = USF_temp.3 days = 400}
					country_event = {id = USF_temp.4 days = 700}
					country_event = {id = USF_temp.5 days = 1000}
					country_event = {id = USF_temp.6 days = 1500}
				}
				

			}
			NSJ = {
				country_event = {id = NSJ.1 days = 1000}
			}

			LUA = {
				every_owned_state = {
					add_dynamic_modifier = {modifier = LUA_pandemic_3}
				}
				LUA_mission_setup = yes
			}
		}
	}

	#加的紧急防卫法案 by 白衣
	on_declare_war = {
		effect = {
			if = {
				limit = {
					always = no
					OR = {
						FROM = {
							tag = USF
						}
						ROOT = {
							tag = USF
						}
					}
					FROM = {
						NOT = {
							original_tag = BRG
							original_tag = OCF
						}
					}
				}
				USF = {
					if = {
						limit = {
							USR = {
								is_faction_leader = yes
							}
						}
						USR = {
							add_to_faction = USF
						}
					}
				}
			}
		}
	}

	on_daily_USF = {
		effect = {
			USF = {
				USF_calculate_act_time = yes
			}
		}
	}
	on_weekly_USF = {
		effect = {
			USF = {
				USF_refresh_congress = yes
				if = {
					limit = {
						check_variable = {USF_econ_sphere_available_points > 0}
					}
					set_temp_variable = { alert_id = token:alert_USF_available_points }
					add_IRIS_alert_unless_exists = yes
				}
				if = {
					limit = {
						check_variable = {USF_econ_sphere_available_points < 1}
					}
					set_temp_variable = { alert_id = token:alert_USF_available_points }
					del_IRIS_alert = yes
				}
				if = {
					limit = {
						has_country_flag = USF_encourage_investment
					}
					USF_refresh_encourage_investment_result = yes
				}
				if = {
					limit = {
						has_country_leader_with_trait = TRAIT_USF_SECOND_CHANCE
					}
					USF_calculate_infrastructure_coverage_ratio = yes
				}
				if = {
					limit = {
						has_country_leader_with_trait = TRAIT_USF_PRO_MILITARY
					}
					USF_calculate_arms_to_civ_ratio = yes
				}
				if = {
					limit = {
						has_dynamic_modifier = {modifier = USF_free_trade_union}
					}
					USF_refresh_free_trade_union_modifier = yes
				}
				if = {
					limit = {
						has_dynamic_modifier = {modifier = USF_leverage_republic_modifier}
					}
					USF_update_leverage_republic = yes
				}
				if = {
					limit = {
						NOT = {
							has_country_flag = USF_disable_congress_alert
						}
						check_variable = {USF_congress_alert < 1}#防止跳得太频繁
					}
					if = {
						limit = {
							OR = {
								AND = {
									check_variable = {USF.days_mission_timeout@USF_cut_naval_budget_decision < 15}
									check_variable = {USF.days_mission_timeout@USF_cut_naval_budget_decision > 0}
								}
								AND = {
									check_variable = {USF.days_mission_timeout@USF_cut_naval_budget_decision < 15}
									check_variable = {USF.days_mission_timeout@USF_cut_naval_budget_decision > 0}
								}
								AND = {
									check_variable = {USF.days_mission_timeout@USF_impose_excess_profits_tax_decision < 15}
									check_variable = {USF.days_mission_timeout@USF_impose_excess_profits_tax_decision > 0}
								}
								AND = {
									check_variable = {USF.days_mission_timeout@USF_cut_defense_cost_decision < 15}
									check_variable = {USF.days_mission_timeout@USF_cut_defense_cost_decision > 0}
								}
								AND = {
									check_variable = {USF.days_mission_timeout@USF_destory_extra_products_decision < 15}
									check_variable = {USF.days_mission_timeout@USF_destory_extra_products_decision > 0}
								}
								AND = {
									check_variable = {USF.days_mission_timeout@USF_protective_tariff_decision < 15}
									check_variable = {USF.days_mission_timeout@USF_protective_tariff_decision > 0}
								}

								AND = {
									check_variable = {USF.days_decision_timeout@USF_abolish_rights_of_ELN_commissioner_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_abolish_rights_of_ELN_commissioner_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_industrial_stimulus_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_industrial_stimulus_act_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_purchase_ELN_national_debt_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_purchase_ELN_national_debt_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_financial_corporation_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_financial_corporation_act_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_cut_welfare_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_cut_welfare_act_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_increase_tariff_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_increase_tariff_act_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_federal_aduit_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_federal_aduit_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_mana_plant_adjustment_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_mana_plant_adjustment_act_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_reduce_quota_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_reduce_quota_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_federal_insurance_company_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_federal_insurance_company_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_stock_exchange_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_stock_exchange_act_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_industrial_recovery_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_industrial_recovery_act_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_subject_trade_priority_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_subject_trade_priority_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_decrease_subject_autonomy_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_decrease_subject_autonomy_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_complete_BLA_trade_order_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_complete_BLA_trade_order_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_industrial_nationalization_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_industrial_nationalization_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_mana_nationalization_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_mana_nationalization_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_end_emergency_relief_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_end_emergency_relief_act_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_energy_protection_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_energy_protection_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_prohibit_unlawful_forces_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_prohibit_unlawful_forces_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_civil_security_company_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_civil_security_company_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_declare_war_on_TDL_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_declare_war_on_TDL_decision > 0}
								}
								AND = {
									check_variable = {USF.days_decision_timeout@USF_banking_act_decision < 15}
									check_variable = {USF.days_decision_timeout@USF_banking_act_decision > 0}
								}
								
							}
						}
						add_to_array = {IRIS_prompt_alert_operations = 6}
						IRIS_prompt_alert_operation = yes
						add_to_variable = {USF_congress_alert = 1}
					}
				}
				if = {
					limit = {
						check_variable = {USF_congress_alert > 0}
					}
					add_to_variable = {USF_congress_alert = -1}
				}
			}
		}
	}
	on_monthly_USF = {
		effect = {
			USF = {
				if = {
					limit = {
						has_country_flag = USF_econ_sphere_enabled
					}
					USF_econ_sphere_available_points_monthly_update = yes
				}
				USF_monthly_inflation_change = yes
				if = {
					limit = {
						has_completed_focus = USF_raise_trade_barrier
						has_dynamic_modifier = {modifier = USF_trade_protectionism}
					}
					USF_refresh_tariff_target_array = yes
				}
				if = {
					limit = {
						has_country_leader_with_trait = TRAIT_USF_SECOND_CHANCE
					}
					USF_Herbert_cic_bonus = yes
				}
				if = {
					limit = {
						has_country_leader_with_trait = TRAIT_USF_PRO_MILITARY
					}
					USF_Kay_cic_bonus = yes
				}
				if = {
					limit = {
						has_completed_focus = USF_public_infrastructure_projects
						check_variable = {USF_public_infrastructure_projects_b < 10}
					}
					set_temp_variable = {USF_unemployment_temp = -0.5}
					USF_change_unemployment_effect = yes
					add_to_variable = {USF_public_infrastructure_projects_b = 1}
				}
				if = {
					limit = {
						has_completed_focus = USF_work_relief
						check_variable = {USF_work_relief_b < 10}
					}
					set_temp_variable = {USF_unemployment_temp = -0.5}
					USF_change_unemployment_effect = yes
					add_to_variable = {USF_work_relief_b = 1}
				}
			}
		}
	}
	on_weekly_USF = {
		effect = {
			USF = {
				USF_calculate_economic_line_chart_weekly = yes
			}
		}
	}

	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = { state = 667 }
				}
				if = {
					limit = {
						ROOT = {
							tag = NSJ
						}
						FROM = {
							OR = {
								tag = TDL
								is_subject_of = TDL
							}
						}
					}
					NSJ = {country_event = {id = NSJ_temp.1}}
				}
			}
		}
	}
	on_capitulation = {
        effect = {
            if = {
                limit = {
					has_global_flag = USF_SAS_CAMPAIGN
                    FROM = {
                        OR = {
							tag = USF
							is_subject_of = USF
							is_in_faction_with = USF
						}
                    }
                    ROOT = {
                        is_IRIS_SAS_sub_country = yes
                    }
                }
				set_global_flag = show_peace_popup_alert
				set_global_flag = war_won
				FROM = {
					save_global_event_target_as = winning_country
				}
				ROOT = {
					save_global_event_target_as = losing_country
				}
				IRIS_peace_popup_determine_allies = yes
				add_to_variable = { global.peace_popup_dirty = 1 }


				USF = {
					set_autonomy = {
						target = ROOT
						autonomous_state = USF_territory
						end_wars = yes
					}
				}
				
            }
			if = {
				limit = {
					has_global_flag = USF_CIV_WAR_STARTED
					ROOT = {
						tag = UAS
					}
					FROM = {
						OR = {
							tag = USF
							is_in_faction_with = USF
							is_subject_of = USF
						}
					}
				}

				set_global_flag = show_peace_popup_alert
				set_global_flag = war_won
				USF = {
					save_global_event_target_as = winning_country
				}
				ROOT = {
					save_global_event_target_as = losing_country
				}
				IRIS_peace_popup_determine_allies = yes
				add_to_variable = { global.peace_popup_dirty = 1 }

				set_global_flag = USF_CIV_WAR_ENDED
				UAS = {
					transfer_navy = {
						target = USF
					}
				}
				USF = {
					annex_country = {
						target = UAS
					}
					news_event = {id = USF_news.9 days = 3}
					country_event = {id = USF_civ_war.4 days = 5}
				}
				every_state = {
					limit = {
						is_core_of = UAS
					}
					remove_core_of = UAS
				}
			}
			if = {
				limit = {
					has_global_flag = USF_CIV_WAR_STARTED
					ROOT = {
						tag = USF
					}
					FROM = {
						OR = {
							tag = UAS
							is_in_faction_with = UAS
							is_subject_of = UAS
						}
					}
				}

				set_global_flag = show_peace_popup_alert
				set_global_flag = war_won
				UAS = {
					save_global_event_target_as = winning_country
				}
				ROOT = {
					save_global_event_target_as = losing_country
				}
				IRIS_peace_popup_determine_allies = yes
				add_to_variable = { global.peace_popup_dirty = 1 }

				set_global_flag = USF_CIV_WAR_ENDED
				USF = {
					transfer_navy = {
						target = UAS
					}
				}
				UAS = {
					
					if = {
						limit = {
							LUA = {
								exists = yes
							}
						}
						set_autonomy = {
							target = LUA
							autonomous_state = USF_homeland_state
						}
						LUA = {
							clr_country_flag = has_Anarchy_flag
							every_owned_state = {
								set_demilitarized_zone = no
							}
						}
					}
					if = {
						limit = {
							USN = {
								exists = yes
								is_subject_of = USF
							}
						}
						white_peace = USN
						set_autonomy = {
							target = USN
							autonomous_state = USF_homeland_state
						}
					}
					if = {
						limit = {
							RUM = {
								exists = yes
								is_subject_of = USF
							}
						}
						white_peace = RUM
						set_autonomy = {
							target = RUM
							autonomous_state = autonomy_dominion
						}
					}
					if = {
						limit = {
							NSJ = {
								exists = yes
								is_subject_of = USF
							}
						}
						white_peace = NSJ
						set_autonomy = {
							target = NSJ
							autonomous_state = naval_command
						}
					}
					annex_country = {
						target = USF
					}
				}
				every_state = {
					limit = {
						is_core_of = USF
					}
					add_core_of = UAS
				}
			}
        }
    }
}
