on_actions = {
	on_startup = {
		effect = {

			USF = {

				#防止变成幽灵部队
				load_oob = "USF"
				load_oob = "USF_naval"
				load_oob = "USF_air"


				if = {
					limit = {
						#always = no #没做完捏
						always = yes
					}
					activate_mission = USF_cut_naval_budget_decision
					activate_mission = USF_impose_excess_profits_tax_decision
					activate_mission = USF_cut_defense_cost_decision
					activate_mission = USF_destory_extra_products_decision
					activate_mission = USF_election_result
				}

				country_event = {id = USF.2 days = 3}
				country_event = {id = USF_flavor.1 days = 42}
				country_event = {id = USF.8 days = 14}
				country_event = {id = USF.14 days = 60}
				country_event = {id = NSJ.1 days = 1000}
				USF_test_line = yes
				USF_pandemic_setup = yes

				if = {
					limit = {
						always = no
					}
					#骨架事件
					country_event = {id = USF_temp.1 days = 365}
					country_event = {id = USF_temp.2 days = 680}
					country_event = {id = USF_temp.3 days = 400}
					country_event = {id = USF_temp.4 days = 700}
					country_event = {id = USF_temp.5 days = 1000}
					country_event = {id = USF_temp.6 days = 1500}
				}
				

			}
			NSJ = {
				country_event = {id = NSJ.1 days = 1000}
			}
		}
	}

	#加的紧急防卫法案 by 白衣
	on_declare_war = {
		effect = {
			if = {
				limit = {
					OR = {
						FROM = {
							tag = USF
						}
						ROOT = {
							tag = USF
						}
					}
					FROM = {
						NOT = {
							original_tag = BRG
							original_tag = OCF
						}
					}
				}
				USF = {
					if = {
						limit = {
							USR = {
								is_faction_leader = yes
							}
						}
						USR = {
							add_to_faction = USF
						}
					}
				}
			}
		}
	}

	on_daily_USF = {
		effect = {
			USF = {
				USF_calculate_act_time = yes
			}
		}
	}
	on_weekly_USF = {
		effect = {
			USF = {
				USF_refresh_congress = yes
				USF_calculate_pandemic_mtth = yes
				if = {
					limit = {
						has_country_flag = USF_encourage_investment
					}
					USF_refresh_encourage_investment_result = yes
				}
				if = {
					limit = {
						has_country_leader_with_trait = TRAIT_USF_SECOND_CHANCE
					}
					USF_calculate_infrastructure_coverage_ratio = yes
				}
				if = {
					limit = {
						has_country_leader_with_trait = TRAIT_USF_PRO_MILITARY
					}
					USF_calculate_arms_to_civ_ratio = yes
				}
				if = {
					limit = {
						has_dynamic_modifier = {modifier = USF_free_trade_union}
					}
					USF_refresh_free_trade_union_modifier = yes
				}
				if = {
					limit = {
						has_dynamic_modifier = {modifier = USF_leverage_republic_modifier}
					}
					USF_update_leverage_republic = yes
				}
			}
		}
	}
	on_monthly_USF = {
		effect = {
			USF = {
				USF_monthly_inflation_change = yes
				if = {
					limit = {
						has_completed_focus = USF_raise_trade_barrier
						has_dynamic_modifier = {modifier = USF_trade_protectionism}
					}
					USF_refresh_tariff_target_array = yes
				}
				if = {
					limit = {
						has_country_leader_with_trait = TRAIT_USF_SECOND_CHANCE
					}
					USF_Herbert_cic_bonus = yes
				}
				if = {
					limit = {
						has_country_leader_with_trait = TRAIT_USF_PRO_MILITARY
					}
					USF_Kay_cic_bonus = yes
				}
			}
		}
	}
	on_weekly_USF = {
		effect = {
			USF = {
				USF_calculate_economic_line_chart_weekly = yes
			}
		}
	}

	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = { state = 667 }
				}
				if = {
					limit = {
						ROOT = {
							tag = NSJ
						}
						FROM = {
							OR = {
								tag = TDL
								is_subject_of = TDL
							}
						}
					}
					NSJ = {country_event = {id = NSJ_temp.1}}
				}
			}
		}
	}
	on_capitulation = {
        effect = {
            if = {
                limit = {
					has_global_flag = USF_SAS_CAMPAIGN
                    FROM = {
                        OR = {
							tag = USF
							is_subject_of = USF
							is_in_faction_with = USF
						}
                    }
                    ROOT = {
                        is_IRIS_SAS_sub_country = yes
                    }
                }
				set_global_flag = show_peace_popup_alert
				set_global_flag = war_won
				FROM = {
					save_global_event_target_as = winning_country
				}
				ROOT = {
					save_global_event_target_as = losing_country
				}
				IRIS_peace_popup_determine_allies = yes
				add_to_variable = { global.peace_popup_dirty = 1 }


				USF = {
					annex_country = {
						target = ROOT
						transfer_troops = no
					}
				}
				
            }
			if = {
				limit = {
					has_global_flag = USF_CIV_WAR_STARTED
					ROOT = {
						tag = UAS
					}
					FROM = {
						OR = {
							tag = USF
							is_in_faction_with = USF
							is_subject_of = USF
						}
					}
				}

				set_global_flag = show_peace_popup_alert
				set_global_flag = war_won
				USF = {
					save_global_event_target_as = winning_country
				}
				ROOT = {
					save_global_event_target_as = losing_country
				}
				IRIS_peace_popup_determine_allies = yes
				add_to_variable = { global.peace_popup_dirty = 1 }

				set_global_flag = USF_CIV_WAR_ENDED
				UAS = {
					transfer_navy = {
						target = USF
					}
				}
				USF = {
					annex_country = {
						target = UAS
					}
					country_event = {id = USF_civ_war.4 days = 3}
				}
				every_state = {
					limit = {
						is_core_of = UAS
					}
					remove_core_of = UAS
				}
			}
			if = {
				limit = {
					has_global_flag = USF_CIV_WAR_STARTED
					ROOT = {
						tag = USF
					}
					FROM = {
						OR = {
							tag = UAS
							is_in_faction_with = UAS
							is_subject_of = UAS
						}
					}
				}

				set_global_flag = show_peace_popup_alert
				set_global_flag = war_won
				UAS = {
					save_global_event_target_as = winning_country
				}
				ROOT = {
					save_global_event_target_as = losing_country
				}
				IRIS_peace_popup_determine_allies = yes
				add_to_variable = { global.peace_popup_dirty = 1 }

				set_global_flag = USF_CIV_WAR_ENDED
				USF = {
					transfer_navy = {
						target = UAS
					}
				}
				UAS = {
					
					if = {
						limit = {
							LUA = {
								exists = yes
							}
						}
						set_autonomy = {
							target = LUA
							autonomous_state = USF_homeland_state
						}
						LUA = {
							clr_country_flag = has_Anarchy_flag
							every_owned_state = {
								set_demilitarized_zone = no
							}
						}
					}
					if = {
						limit = {
							USN = {
								exists = yes
								is_subject_of = USF
							}
						}
						white_peace = USN
						set_autonomy = {
							target = USN
							autonomous_state = USF_homeland_state
						}
					}
					if = {
						limit = {
							RUM = {
								exists = yes
								is_subject_of = USF
							}
						}
						white_peace = RUM
						set_autonomy = {
							target = RUM
							autonomous_state = autonomy_dominion
						}
					}
					if = {
						limit = {
							NSJ = {
								exists = yes
								is_subject_of = USF
							}
						}
						white_peace = NSJ
						set_autonomy = {
							target = NSJ
							autonomous_state = naval_command
						}
					}
					annex_country = {
						target = USF
					}
				}
				every_state = {
					limit = {
						is_core_of = USF
					}
					add_core_of = UAS
				}
			}
        }
    }
}
