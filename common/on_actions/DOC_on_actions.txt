on_actions = {
	on_startup = {
		effect = {
            PLD = { country_event = { id = PLD.1 days = 7 } }
             every_country = {
                #动态战争修正
                #p社沙比，运算只可以一个一个算，还计算报错
                set_variable = { DOC_morale = -25 } 
            }
            every_state = {
				limit = {
					is_core_of = DOC
				}
				add_core_of = CNI
			}
            DOC = {
                add_opinion_modifier = {
					target = OCE
					modifier = Strategic_hostility
				}
                set_autonomy = {
	                target = PLD
	                autonomous_state = separatist_forces
                }
                add_opinion_modifier = {
					target = PLD
					modifier = separatist_forces
				}
                add_dynamic_modifier = { modifier = DOC_local_aristocratic_dissatisfaction }
                DOC_random_opposition_name = YES
                set_country_flag = DOC_eldest_son_faction_exists_flag
            }
            PLD = {
                set_politics = {
	                ruling_party = neutrality
	                last_election = "3090.1.1"
	                election_frequency = 144
	                elections_allowed = no
                }

                set_popularities = {
	                neutrality = 30
	                democratic = 5
	                communism = 2
	                fascism = 0
	                reactionism = 63
                }
                white_peace = OCE
            }
            set_variable = { DOC_noble_dissatisfaction = 0.18 }#贵族不满
            set_variable = { DOC_progress_riots = 0 }#暴乱进度
            set_variable = { global.CNI_summoned_times = 1 }#可召唤次数
            

            set_variable = { DOC_local_aristocratic_dissatisfaction_stability_factor = 0 }#稳定度
            set_variable = { DOC_local_aristocratic_dissatisfaction_production_factory_max_efficiency_factor = 0 }#生产效率上限
        }
    }
    on_daily_DOC = {
        effect = {
            if = {
                limit = { has_country_flag = DOC_process_of_democratization_flag }
                DOC_calculate_existing_parcel_logic = yes
            }
            DOC_local_aristocratic_dissatisfaction_calculate = yes
            if = {
                limit = { DOC = { NOT = { has_government = ELN } is_in_faction_with = ELN } ELN = { is_faction_leader = yes } }
                DOC = { leave_faction = yes }
            }
            if = {
                limit = { NOT = { check_variable = { DOC_progress_riots < 1 } } }
                DOC_local_aristocratic_dissatisfaction_calculate_work_out = yes
                CNI = { declare_war_on = { target = DOC type = annex_everything } }
                set_variable = { DOC_progress_riots = 0 }
                clear_array = global.DOC_opposition_bg_window_list_change_record_array
				clear_array = global.DOC_opposition_bg_window_list_change_2_record_array
				clear_array = global.DOC_emblem_icon_window_list_change_1_array
				clear_array = global.DOC_emblem_icon_window_list_change_2_array
				clear_array = global.DOC_emblem_icon_window_list_change_3_array
				clear_array = global.DOC_emblem_icon_window_list_change_4_array
            }
        }
    }
    on_monthly_DOC = {
        effect = {
            if = {
                limit = { has_country_flag = DOC_process_of_democratization_flag }
                if = {
                    limit = { NOT = { check_variable = { DOC_noble_dissatisfaction < 0.5 } } }
                    add_to_variable = { DOC_progress_riots = 0.25 } 
                    if = {
                        limit = { check_variable = { global.DOC_opposition_bg_window_list_change_record_array^num < 5 } }
                        DOC_random_opposition_name = yes
                        add_to_variable = { global.CNI_summoned_times = 1 } 
                    }
                }else = {
                    add_to_variable = { DOC_progress_riots = -0.1 } 
                }
                add_to_variable = { DOC_noble_dissatisfaction = -0.015 } 
            }
        }
    }
    
    on_capitulation_immediate = {
        effect = {
            #诗旎公国宣布投降废弃
            if = {
                limit = {
                    ROOT = {
			    		original_tag = DOC
			    	}
                }
                if = {
				    limit = {
				    	FROM = {
				    		original_tag = OCE
				    	}
				    }
				    country_event = { id = OCE.6 }
			    }
                every_state = {
                    limit = {
                        is_core_of = CNI
                    }
                    remove_core_of = CNI
                }
            }
        }
    }
}
