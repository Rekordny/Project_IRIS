add_namespace = TDL_temp

#骨架事件

country_event = {#闪电般归来
    id = TDL_temp.1
    title = TDL_temp.1.t
    desc = TDL_temp.1.desc
    #picture = GFX_event_TDL_temp_1
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.1.a
        remove_ideas = TDL_Political_chaos
        add_popularity = {
            ideology = neutrality
            popularity = 0.2
        }
        annex_country = {
            target = TER
            transfer_troops = yes
        }
        TER = {
            every_character = {
                set_nationality = TDL
            }
        }
        set_politics = {
            ruling_party = neutrality
        }
        promote_character = {
            character = TDL_Constantine
            ideology = sub_enlightened_despotism
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#经济危机缓和
    id = TDL_temp.2
    title = TDL_temp.2.t
    desc = TDL_temp.2.desc
    #picture = GFX_event_TDL_temp_2
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.2.a

        remove_ideas = TDL_Black_Foaming_Night

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#整军备战
    id = TDL_temp.3
    title = TDL_temp.3.t
    desc = TDL_temp.3.desc
    #picture = GFX_event_TDL_temp_3
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.3.a

        add_ideas = partial_economic_mobilisation
        add_ideas = extensive_conscription
        set_technology = {magic_shield_upgrade_1 = 1}

        division_template = {
            name = "帝国军团"
            regiments = {
                Arcane_Battle_Camp = {x = 0 y = 0}
                Arcane_Battle_Camp = {x = 0 y = 1}
                Arcane_Battle_Camp = {x = 0 y = 2}
                Arcane_Battle_Camp = {x = 1 y = 0}
                Arcane_Battle_Camp = {x = 1 y = 1}
                Arcane_Battle_Camp = {x = 1 y = 2}
                Arcane_Battle_Camp = {x = 2 y = 0}
                Arcane_Battle_Camp = {x = 2 y = 1}
                Arcane_Battle_Camp = {x = 2 y = 2}
                Arcane_Knights_Camp = {x = 3 y = 0}
            }
            support = {
                magic_engineer_company = {x = 0 y = 0}
            }
        }
        division_template = {
            name = "帝国辅兵"
            regiments = {
                infantry = {x = 0 y = 0}
                infantry = {x = 0 y = 1}
                infantry = {x = 0 y = 2}
                infantry = {x = 1 y = 0}
                infantry = {x = 1 y = 1}
                infantry = {x = 1 y = 2}
            }
        }

        random_owned_controlled_state = {
            add_extra_state_shared_building_slots = 2
            add_building_construction = {
                type = arms_factory
                level = 2
                instant_build = yes
            }
        }
        random_owned_controlled_state = {
            add_extra_state_shared_building_slots = 2
            add_building_construction = {
                type = arms_factory
                level = 2
                instant_build = yes
            }
        }
        random_owned_controlled_state = {
            add_extra_state_shared_building_slots = 2
            add_building_construction = {
                type = arms_factory
                level = 2
                instant_build = yes
            }
        }

        for_loop_effect = {
            start = 0
            end = 4
            capital_scope = {
                create_unit = {
                    division = "name = \"帝国军团\" division_template = \"帝国军团\" start_experience_factor = 0.30"
                    owner = TDL
                }
            }
        }
        for_loop_effect = {
            start = 0
            end = 6
            capital_scope = {
                create_unit = {
                    division = "name = \"帝国辅兵\" division_template = \"帝国辅兵\" start_experience_factor = 0.20"
                    owner = TDL
                }
            }
        }

        add_ai_strategy = {
            type = build_army
            id = infantry
            value = 200
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#开战
    id = TDL_temp.4
    title = TDL_temp.4.t
    desc = TDL_temp.4.desc
    #picture = GFX_event_TDL_temp_4
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.4.a

        set_global_flag = TDL_RECLAIM_WAR

        every_country = {
            limit = {
                is_IRIS_SAS_sub_country = yes
                NOT = {
                    tag = ROOT
                    is_subject_of = ROOT
                }
            }
            declare_war_on = {
                target = PREV
                type = annex_everything
            }
        }
        add_ideas = war_economy

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#合众国制裁
    id = TDL_temp.5
    title = TDL_temp.5.t
    desc = TDL_temp.5.desc
    #picture = GFX_event_TDL_temp_5
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.5.a

        add_ideas = TDL_LOCK

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#皇国援助？
    id = TDL_temp.6
    title = TDL_temp.6.t
    desc = TDL_temp.6.desc
    #picture = GFX_event_TDL_temp_6
    trigger = {
        tag = TDL
        has_global_flag = TDL_RECLAIM_WAR
        NOT = {
            has_war_with = AKL
        }
        AKL = {
            exists = yes
            has_country_flag = AKL_TDL_cooperation
        }
    }
    fire_only_once = yes

    mean_time_to_happen = {
        days = 7
    }

    option = {
        name = TDL_temp.6.a

        add_manpower = 5000
        add_equipment_to_stockpile = {
            type = convoy
            amount = 100
            producer = AKL
        }
        add_equipment_to_stockpile = {
            type = mana_infantry_weapons
            amount = 2000
            producer = AKL
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#纳特拉卖国
    id = TDL_temp.7
    title = TDL_temp.7.t
    desc = TDL_temp.7.desc
    #picture = GFX_event_TDL_temp_7
    trigger = {
        tag = TDL
        has_war_with = NAT
        NAT = {
            surrender_progress > 0.49
        }
        has_global_flag = TDL_RECLAIM_WAR
    }
    fire_only_once = yes

    mean_time_to_happen = {
        days = 3
    }

    option = {
        name = TDL_temp.7.a

        white_peace = NAT

        set_autonomy = {
            target = NAT
            autonomous_state = TDL_imperial_province
        }

        NAT = {
            set_cosmetic_tag = NAT_PROVINCE
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#击败弗雷梅维拉后组建第七军团
    id = TDL_temp.8
    title = TDL_temp.8.t
    desc = TDL_temp.8.desc
    #picture = GFX_event_TDL_temp_8
    trigger = {
        tag = TDL
        has_global_flag = TDL_RECLAIM_WAR
        636 = {
            is_controlled_by_ROOT_or_ally = yes
        }
    }
    fire_only_once = yes
    mean_time_to_happen = {
        days = 3
    }

    option = {
        name = TDL_temp.8.a
        
        division_template = {
            name = "第七军团"
            regiments = {
                Arcane_Battle_Camp = {x = 0 y = 0}
                Arcane_Battle_Camp = {x = 0 y = 1}
                Arcane_Battle_Camp = {x = 0 y = 2}
                Arcane_Battle_Camp = {x = 0 y = 3}
            }
            support = {
                magic_recon_company = {x = 0 y = 0}
            }
        }
        for_loop_effect = {
            start = 0
            end = 7
            capital_scope = {
                create_unit = {
                    division = "name = \"第七军团\" division_template = \"第七军团\" start_experience_factor = 0.3"
                    owner = YMI
                }
            }
        }
        

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#帝国西疆
    id = TDL_temp.9
    title = TDL_temp.9.t
    desc = TDL_temp.9.desc
    #picture = GFX_event_TDL_temp_9
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.9.a
        every_state = {
            limit = {
                OR = {
                    is_core_of = BLN
                    is_core_of = XZJ
                    is_core_of = HBG
                }
                owner = {
                    OR = {
                        tag = TDL
                        is_subject_of = TDL
                    }
                }
            }
            transfer_state_to = TEW
            add_core_of = TEW
        }
        set_autonomy = {
            target = TEW
            autonomous_state = TDL_imperial_province
        }
        TEW = {
            inherit_technology = TDL
        }

        country_event = {id = TDL_temp.11 days = 750}

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#完全胜利
    id = TDL_temp.10
    title = TDL_temp.10.t
    desc = TDL_temp.10.desc
    #picture = GFX_event_TDL_temp_10
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.10.a
        add_political_power = 200
        add_stability = 0.25
        add_war_support = 0.25

        set_global_flag = TDL_RECLAIM_WAR_ENDED

        
        country_event = {id = TDL_temp.9 days = 3}
        
        
        every_state = {
            limit = {
                OR = {
                    is_core_of = YMI
                    is_core_of = ATM
                }
                is_controlled_by_ROOT_or_ally = yes
            }
            add_core_of = TDL
            transfer_state_to = TDL
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#整合西疆
    id = TDL_temp.11
    title = TDL_temp.11.t
    desc = TDL_temp.11.desc
    #picture = GFX_event_TDL_temp_11
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.11.a

        annex_country = {
            target = TEW
            transfer_troops = yes
        }

        every_state = {
            limit = {
                is_core_of = TEW
            }
            add_core_of = TDL
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#小胜 占领YMI
    id = TDL_temp.12
    title = TDL_temp.12.t
    desc = TDL_temp.12.desc
    #picture = GFX_event_TDL_temp_12
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.12.a
        add_political_power = 50
        add_stability = 0.05
        add_war_support = 0.05

        set_global_flag = TDL_RECLAIM_WAR_ENDED

        every_enemy_country = {
            limit = {
                is_IRIS_SAS_sub_country = yes
            }
            white_peace = PREV
        }

        every_state = {
            limit = {
                OR = {
                    is_core_of = YMI
                }
                is_controlled_by_ROOT_or_ally = yes
            }
            add_core_of = TDL
            transfer_state_to = TDL
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#大胜 占领YMI ATM
    id = TDL_temp.13
    title = TDL_temp.13.t
    desc = TDL_temp.13.desc
    #picture = GFX_event_TDL_temp_13
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.13.a
        add_political_power = 100
        add_stability = 0.15
        add_war_support = 0.15

        set_global_flag = TDL_RECLAIM_WAR_ENDED

        every_enemy_country = {
            limit = {
                is_IRIS_SAS_sub_country = yes
            }
            white_peace = PREV
        }

        every_state = {
            limit = {
                OR = {
                    is_core_of = YMI
                    is_core_of = ATM
                }
                is_controlled_by_ROOT_or_ally = yes
            }
            add_core_of = TDL
            transfer_state_to = TDL
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#白和
    id = TDL_temp.14
    title = TDL_temp.14.t
    desc = TDL_temp.14.desc
    #picture = GFX_event_TDL_temp_14
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.14.a

        set_global_flag = TDL_RECLAIM_WAR_ENDED

        every_enemy_country = {
            limit = {
                is_IRIS_SAS_sub_country = yes
            }
            white_peace = PREV
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#战败，吐出TER
    id = TDL_temp.15
    title = TDL_temp.15.t
    desc = TDL_temp.15.desc
    #picture = GFX_event_TDL_temp_15
    is_triggered_only = yes
    fire_only_once = yes

    option = {
        name = TDL_temp.15.a

        add_political_power = -100
        add_stability = -0.1
        add_war_support = -0.1

        set_global_flag = TDL_RECLAIM_WAR_ENDED

        every_enemy_country = {
            limit = {
                is_IRIS_SAS_sub_country = yes
            }
            white_peace = PREV
        }

        if = {
            limit = {
                NAT = {
                    exists = yes
                }
            }
            if = {
                limit = {
                    NAT = {
                        is_subject_of = TDL
                    }
                }
                end_puppet = NAT
                819 = {
                    if = {
                        limit = {
                            is_owned_by = TDL
                        }
                        transfer_state_to = NAT
                    }
                }
                543 = {
                    if = {
                        limit = {
                            is_owned_by = TDL
                        }
                        transfer_state_to = NAT
                    }
                }
            }
        }
        if = {
            limit = {
                YMI = {
                    exists = yes
                }
            }
            820 = {
                if = {
                    limit = {
                        is_owned_by = TDL
                    }
                    transfer_state_to = YMI
                }
            }
            804 = {
                if = {
                    limit = {
                        is_owned_by = TDL
                    }
                    transfer_state_to = YMI
                }
            }
        }

        ai_chance = {
            base = 10
        }
    }
}

country_event = {#南阿西娅同盟
    id = TDL_temp.16
    title = TDL_temp.16.t
    desc = TDL_temp.16.desc
    #picture = GFX_event_TDL_temp_16
    trigger = {
        tag = WRQ
        has_global_flag = TDL_RECLAIM_WAR
        NOT = {
            has_global_flag = TDL_RECLAIM_WAR_ENDED
        }
        TDL = {
            any_enemy_country = {
                is_IRIS_SAS_sub_country = yes
            }
        }
    }
    mean_time_to_happen = {
        days = 7
    }

    fire_only_once = yes

    option = {
        name = TDL_temp.16.a

        set_global_flag = SAS_ALLIANCE

        #由YMI优先

        if = {
            limit = {
                YMI = {
                    exists = yes
                    is_subject = no
                }
            }
            YMI = {
                create_faction = YMI_FACTION_TEMP
                if = {
                    limit = {
                        has_global_flag = ATM_CIV_WAR_ENDED
                    }
                    if = {
                        limit = {
                            country_exists = ATS
                        }
                        add_to_faction = ATS #学生救国军胜利
                    }
                }
                if = {
                    limit = {
                        has_global_flag = BLN_CIV_WAR_ENDED
                    }
                    if = {
                        limit = {
                            country_exists = SCA
                        }
                        add_to_faction = SCA
                    }
                    else_if = {
                        limit = {
                            country_exists = BLN
                        }
                        add_to_faction = BLN
                    }
                }
                if = {
                    limit = {
                        country_exists = HBG
                    }
                    add_to_faction = HBG
                }
                every_country = {
                    limit = {
                        is_in_faction_with = YMI
                    }
                    set_major = yes
                }
            }
            
        }
        #ATS
        else_if = {
            limit = {
                has_global_flag = ATM_CIV_WAR_ENDED
                country_exists = ATS
                ATS = {
                    is_subject = no
                }
            }
            ATS = {
                create_faction = YMI_FACTION_TEMP
                if = {
                    limit = {
                        has_global_flag = BLN_CIV_WAR_ENDED
                    }
                    if = {
                        limit = {
                            country_exists = SCA
                        }
                        add_to_faction = SCA
                    }
                    else_if = {
                        limit = {
                            country_exists = BLN
                        }
                        add_to_faction = BLN
                    }
                }
                if = {
                    limit = {
                        country_exists = HBG
                    }
                    add_to_faction = HBG
                }
                every_country = {
                    limit = {
                        is_in_faction_with = ATS
                    }
                    set_major = yes
                }
            }
        }
        #BLN/SCA
        else_if = {
            limit = {
                has_global_flag = BLN_CIV_WAR_ENDED
            }
            if = {
                limit = {
                    country_exists = BLN
                    country_exists = HBG
                }
                BLN = {
                    create_faction = YMI_FACTION_TEMP
                    add_to_faction = HBG
                }
                every_country = {
                    limit = {
                        is_in_faction_with = BLN
                    }
                    set_major = yes
                }
            }
            else_if = {
                limit = {
                    country_exists = SCA
                    country_exists = HBG
                }
                SCA = {
                    create_faction = YMI_FACTION_TEMP
                    add_to_faction = HBG
                }
                every_country = {
                    limit = {
                        is_in_faction_with = SCA
                    }
                    set_major = yes
                }
            }
        }
        else = {
            #没救了
        }



        ai_chance = {
            base = 10
        }
    }
}

country_event = {#同盟解散
    id = TDL_temp.16
    title = TDL_temp.16.t
    desc = TDL_temp.16.desc
    #picture = GFX_event_TDL_temp_14
    trigger = {
        is_IRIS_SAS_sub_country = yes
        is_faction_leader = yes
        has_global_flag = SAS_ALLIANCE
    }
    fire_only_once = yes

    mean_time_to_happen = {
        days = 3
    }

    option = {
        name = TDL_temp.16.a

        dismantle_faction = yes

        ai_chance = {
            base = 10
        }
    }
}